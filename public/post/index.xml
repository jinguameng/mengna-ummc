<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Posts | Mengna&#39;s Space</title>
    <link>/post/</link>
      <atom:link href="/post/index.xml" rel="self" type="application/rss+xml" />
    <description>Posts</description>
    <generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator><language>en-us</language><lastBuildDate>Fri, 10 Apr 2020 00:00:00 +0000</lastBuildDate>
    <image>
      <url>img/map[gravatar:%!s(bool=false) shape:circle]</url>
      <title>Posts</title>
      <link>/post/</link>
    </image>
    
    <item>
      <title>Homework 9</title>
      <link>/post/bds751hw9/</link>
      <pubDate>Fri, 10 Apr 2020 00:00:00 +0000</pubDate>
      <guid>/post/bds751hw9/</guid>
      <description>


&lt;div id=&#34;question-1&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 1&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;Let X=the number of shared IBD alleles (Score: 15)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;a. What is the distribution of X for a sibling pair and what is the coefficient of relationship and kinship coefficient? (Score 5)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;For a sibling pair, X could be 0, 1, 2&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(f_X(x) = \begin{cases}\pi_0,\ if\  x = 0\\ \pi_1,\  if \ x = 1 \\ \pi_2,\  if \ x =2\end{cases}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;And in this case, &lt;span class=&#34;math inline&#34;&gt;\(\pi_0 = \frac{1}{4}\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(\pi_1 = \frac{1}{2}\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(\pi_2 = \frac{1}{4}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Coeficaient of relationship: &lt;span class=&#34;math inline&#34;&gt;\(E(x) = 0 * \pi_0 + 1 * \pi_1 + 2*\pi_2 \\ = 0 + \frac{1}{2} + \frac{1}{2} = 1\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Kinship coefficient: &lt;span class=&#34;math inline&#34;&gt;\(\varphi = \frac{E(X)}{4} = \frac{1}{4}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;b. What is the distribution of X for a parent-child pair and what is the coefficient of relationship and kinship coefficient? (Score 5)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;There is only one shared IBD allele between a parent-child pair, and it is also the only situation can happen for a parent-child pair.&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(\pi_0 = 0\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(\pi_1 = 1\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(\pi_2 = 2\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Coeficaient of relationship: &lt;span class=&#34;math inline&#34;&gt;\(E(x) = 0 * \pi_0 + 1 * \pi_1 + 2*\pi_2 \\ = 0 + 1*1 + 0 = 1\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Kinship coefficient: &lt;span class=&#34;math inline&#34;&gt;\(\varphi = \frac{E(X)}{4} = \frac{1}{4}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;c. What is the distribution of X for a grandparent-grandchild pair and what is the coefficient of relationship and kinship coefficient? (Score 5)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;There must be one shared IBD allele between a parent-child pair, hence, the child must has an allele which is come from his/her grandmother or grandfather.&lt;/p&gt;
&lt;p&gt;So, &lt;span class=&#34;math inline&#34;&gt;\(\pi_0 = 0\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(\pi_1 = \frac{1}{2}\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(\pi_2 = 0\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Coeficaient of relationship: &lt;span class=&#34;math inline&#34;&gt;\(E(x) = 0 * \pi_0 + 1 * \pi_1 + 2*\pi_2 \\ = 0 + 1*\frac{1}{2} + 0 = \frac{1}{2}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Kinship coefficient: &lt;span class=&#34;math inline&#34;&gt;\(\varphi = \frac{E(X)}{4} = \frac{1}{8}\)&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-2&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 2&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;Suppose a disease has autosome dominant inheritance of allele D for a gene locus with allele D and d (i.e. Pr(Y=1|G)=1 if G=DD or Dd, and Pr(Y=1|G)=0 if G=dd). Let X=the number of shared IBD alleles between an affected sibling pair. (Score: 15)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;a. If father genotype is Dd and mother genotype is dd, what is probability of X=0, 1 and 2 respectively? (Score: 5)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Children’s possible genotypes:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(D_fd_f\ \times\  d_{m1}d_{m2} =&amp;gt; \begin{cases}D_fd_{m1},\ Pr = \frac{1}{4} \\ D_fd_{m2},\ Pr = \frac{1}{4} \\d_fd_{m1},\ Pr = \frac{1}{4} \\d_fd_{m2},\ Pr = \frac{1}{4} \end{cases}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;And among those four cases, only &lt;span class=&#34;math inline&#34;&gt;\(D_fd_{m1}\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(D_fd_{m2}\)&lt;/span&gt; are affected genotype.&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(D_fd_{m1}) = Pr(D_fd_{m2}) = \frac{\frac{1}{4}}{\frac{1}{4} + \frac{1}{4}} = \frac{1}{2}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;By multiplication rule we can calculate the frequency for each X :&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\((\frac{1}{2}D_fd_{m1} + \frac{1}{2}D_fd_{m2})^2\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= \frac{1}{4}(D_fd_{m1}, D_fd_{m1}) + \frac{1}{4}(D_fd_{m2}, D_fd_{m2}) + \frac{1}{2}(D_fd_{m1}, D_fd_{m2})\)&lt;/span&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th&gt;X&lt;/th&gt;
&lt;th&gt;Offerspring Genotypes&lt;/th&gt;
&lt;th&gt;Probability&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\((D_fd_{m1}, D_fd_{m2})\)&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(\frac{1}{2}\)&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\((D_fd_{m1}, D_fd_{m1})\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\((D_fd_{m2}, D_fd_{m2})\)&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(\frac{1}{2}\)&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;So,&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(x) = \begin{cases}0,\  x = 0 \\ \frac{1}{2},\ x = 1 \\ \frac{1}{2},\ x = 2\end{cases}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;b. If father genotype is Dd and mother genotype is also Dd, what is the distribution of X? what is E(X)? and what is the Var(X)? (Score: 10)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Children’s possible genotypes:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(D_fd_f\ \times\  D_{m}d_{m} =&amp;gt; \begin{cases}D_fD_{m},\ Pr = \frac{1}{4} \\ D_fd_{m},\ Pr = \frac{1}{4} \\d_fD_{m},\ Pr = \frac{1}{4} \\d_fd_{m},\ Pr = \frac{1}{4} \end{cases}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;And among those four cases, there are three affected genotypes:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(D_fD_{m}) = Pr(D_fd_{m}) = Pr(d_fD_{m}) = \frac{1/4}{1/4+1/4 +1/4} = \frac{1}{3}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;By multiplication rule we can calculate the frequency for each X :&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\((\frac{1}{3}D_fD_m + \frac{1}{3}D_fd_m + \frac{1}{3}d_fD_m)^2\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= \frac{1}{9}(D_fD_m,D_fD_m) + \frac{1}{9}(D_fd_m,D_fd_m) + \frac{1}{9}(d_fD_m,d_fD_m) + \frac{2}{9}(D_fD_m,D_fd_m) + \frac{2}{9}(D_fD_m,d_fD_m) +\frac{2}{9}(D_fd_m,d_fD_m)\)&lt;/span&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th&gt;X&lt;/th&gt;
&lt;th&gt;Offerspring Genotypes&lt;/th&gt;
&lt;th&gt;Probability&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\((D_fd_m,d_fD_m)\)&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(\frac{2}{9}\)&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\((D_fD_m,D_fd_m)\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\((D_fD_m,d_fD_m)\)&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(\frac{4}{9}\)&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\((D_fD_m,D_fD_m)\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\((D_fd_m,D_fd_m)\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\((d_fD_m,d_fD_m)\)&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(\frac{1}{3}\)&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;So,&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(x) = \begin{cases}\frac{2}{9},\  x = 0 \\ \frac{4}{9},\ x = 1 \\ \frac{1}{3},\ x = 2\end{cases}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(E(X) = 0*\frac{2}{9} + 1*\frac{4}{9} + 2*\frac{1}{3} = \frac{10}{9}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(E(X^2) = 0*\frac{2}{9} + 1*\frac{4}{9} + 4*\frac{1}{3} = \frac{16}{9}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Var(X) = E(X^2) - E(x)^2 = \frac{16}{9} - (\frac{10}{9})^2 = \frac{52}{27}\)&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-3&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 3&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;Let X be the number of shared IBS alleles for a sibling pair with Dd genotype for both parents. What are the E(X) (Score 10) and Var(X)? (Score 15) &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Children’s possible genotypes:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[Dd\ \times\  Dd =&amp;gt; \begin{cases}DD,\ Pr = \frac{1}{4} \\ Dd,\ Pr= \frac{1}{2} \\ dd,\ Pr = \frac{1}{4}  \end{cases}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;By multiplication rule we can calculate the frequency for each X:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\((\frac{1}{4}DD + \frac{1}{2}Dd + \frac{1}{4}dd)^2\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= \frac{1}{16}(DD,DD) + \frac{1}{4}(Dd,Dd) + \frac{1}{16}(dd,dd) + \frac{1}{4}(DD,Dd) + \frac{1}{8}(DD,dd) + \frac{1}{4}(Dd,dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th&gt;X&lt;/th&gt;
&lt;th&gt;Offerspring Genotypes&lt;/th&gt;
&lt;th&gt;Probability&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\((DD,dd)\)&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(\frac{1}{8}\)&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\((DD,Dd)\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\((Dd,dd)\)&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(\frac{1}{2}\)&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\((DD,DD)\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\((Dd,Dd)\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\((dd,dd)\)&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(\frac{3}{8}\)&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;So,&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(x) = \begin{cases}\frac{1}{8},\  x = 0 \\ \frac{1}{2},\ x = 1 \\ \frac{3}{8},\ x = 2\end{cases}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(E(X) = 0*\frac{1}{8} + 1*\frac{1}{2} + 2*\frac{3}{8} = \frac{5}{4}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(E(X^2) = 0*\frac{1}{8} + 1*\frac{1}{2} + 4*\frac{3}{8} = 2\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Var(X) = E(X^2) - E(X)^2 = 2 - (\frac{5}{4})^2 = \frac{7}{16}\)&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-4&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 4&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;a. Fill out the table below. X is a random variable for the number of shared IBS (Score: 10)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;q4a.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;b. For a sibling pair, if pa= 0.5, what is Pr(X=0), Pr(X=1) and Pr(X=2), respectively? What is the E(X) and Var(X)? What are the answers if pa= 0.01. (Score: 5)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;If &lt;span class=&#34;math inline&#34;&gt;\(p_a = 0.5\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(X=0) = 0.5 * 0.5^2 * 0.5^2 = 0.5^5 = 0.03125\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(X=1) = 2 * 0.5^4 + 2 *0.5 ^4 + 2 *0.5 ^4 = 0.375\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(X=2) = 0.5^4 + 2*0.5^4 + 3.5*0.5^4 + 2*0.4^4 + 0.5^4 = 0.59375\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(E(X) = 0*0.03125 + 1*0.375 + 2*0.59375 = 1.5625\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(E(X^2) = 0*0.03125 + 1*0.375 + 4*0.59375 = 2.75\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Var(X) = E(X^2) - E(X)^2 = 2.75 - 1.5625^2 = 0.30859375\)&lt;/span&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;If &lt;span class=&#34;math inline&#34;&gt;\(p_a = 0.01\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(X=0) = 0.5 * 0.01^2 * 0.99^2 = 0.000049005\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(X=1) = 2 * 0.01^3 * 0.99 + 2 *0.01 * 0.99^3 + 2 *0.01^2 * 0.99^2 = 0.01960398\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(X=2) = 0.01^4 + 2*0.01^3 * 0.99 + 3.5*0.01^2 * 0.99^2 + 2*0.01 * 0.99^3 + 0.99^4 = 0.980347015\)&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-5&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 5&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;Causal locus (D and d), LD locus(A and a), f(D) = 0.4, f(A|D) = 0.9, f(A|d) = 0.2. What is the frequency of haplotype DA, haplotype Da, haplotype dA, haplotype da and genotype DdAa in the population? (Score: 10)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;f(D) = 0.4, f(d) = 0.6&lt;/p&gt;
&lt;p&gt;f(A|D) = 0.9, f(a|D) = 0.1&lt;/p&gt;
&lt;p&gt;f(A|d) = 0.2, f(a|d) = 0.8&lt;/p&gt;
&lt;p&gt;Pr(DA) = f(A|D)f(D) = 0.9 * 0.4 = 0.36&lt;/p&gt;
&lt;p&gt;Pr(Da) = f(a|D)f(D) = 0.1 * 0.4 = 0.04&lt;/p&gt;
&lt;p&gt;Pr(dA) = f(A|d)f(d) = 0.2 * 0.6 = 0.12&lt;/p&gt;
&lt;p&gt;Pr(da) = f(a|d)f(d) = 0.8 * 0.6 = 0.48&lt;/p&gt;
&lt;p&gt;Genotype DdAa has two possible haplotype combinations: DA-da and Da-dA.&lt;/p&gt;
&lt;p&gt;Based on multiplication rules, we can get:&lt;/p&gt;
&lt;p&gt;Pr(DdAa) = 2 * 0.36 * 0.48 + 2 * 0.04 * 0.12 = 0.3552&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-6&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 6&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;Causal locus (D and d), LD locus( A and a), f(D) = 0.4, f(A|D) = 0.9, f (A|d) = 0.2. Genotype variable X : the number of D and genotype variable Y : the number of A. What is the covariance of X and Y ? and What is the Correlation? (Score 10) &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;f(D) = 0.4, f(d) = 0.6&lt;/p&gt;
&lt;p&gt;f(A|D) = 0.9, f(a|D) = 0.1&lt;/p&gt;
&lt;p&gt;f(A|d) = 0.2, f(a|d) = 0.8&lt;/p&gt;
&lt;p&gt;Pr(DA) = f(A|D)f(D) = 0.9 * 0.4 = 0.36&lt;/p&gt;
&lt;p&gt;Pr(Da) = f(a|D)f(D) = 0.1 * 0.4 = 0.04&lt;/p&gt;
&lt;p&gt;Pr(dA) = f(A|d)f(d) = 0.2 * 0.6 = 0.12&lt;/p&gt;
&lt;p&gt;Pr(da) = f(a|d)f(d) = 0.8 * 0.6 = 0.48&lt;/p&gt;
&lt;p&gt;From multiplcation rule:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\((0.36DA + 0.04Da + 0.12dA + 0.48da)^2\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= 0.1296(DDAA) + 0.0016(DDaa) + 0.0144(ddAA) + 0.2304(ddaa) + 0.0288(DDAa) + 0.0864(DdAA) + 0.3456(DdAa) + 0.0096(DdAa) + 0.0384(Ddaa) + 0.1152(ddAa)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;For variable X(the number of D):&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th&gt;X&lt;/th&gt;
&lt;th&gt;Genotype&lt;/th&gt;
&lt;th&gt;Probablity&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;ddAA, ddaa, ddAa&lt;/td&gt;
&lt;td&gt;0.36&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;DdAA, DdAa, Ddaa&lt;/td&gt;
&lt;td&gt;0.48&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;DDAA, DDaa, DDAa&lt;/td&gt;
&lt;td&gt;0.16&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;E(X) = 0.48 + 0.16*2 = 0.8&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(E(X^2) = 0.48 + 0.16*4 = 1.12\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Var(X) = E(X^2) - E(X)^2 = 1.12 - 0.8^2 = 0.48\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(sd(X) = \sqrt{Var(X)} = 0.69282\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;For variable Y(the number of A):&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th&gt;Y&lt;/th&gt;
&lt;th&gt;Genotype&lt;/th&gt;
&lt;th&gt;Probablity&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;aaDD, aaDd, aadd&lt;/td&gt;
&lt;td&gt;0.2704&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;AaDD, AaDd, Aadd&lt;/td&gt;
&lt;td&gt;0.4992&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;AADD, AADd, AAdd&lt;/td&gt;
&lt;td&gt;0.2304&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;E(Y) = 0.4992 + 0.2304*2 = 0.96&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(E(Y^2) = 0.4992 + 0.2304*4 = 1.4208\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Var(Y) = E(Y^2) - E(Y)^2 = 1.4208 - 0.96^2 = 0.4992\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(sd(Y) = \sqrt{Var(Y)} = 0.70654\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;For variable (XY):&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th&gt;XY&lt;/th&gt;
&lt;th&gt;Genotype&lt;/th&gt;
&lt;th&gt;Probablity&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;0&lt;/td&gt;
&lt;td&gt;DDaa, ddAA, ddaa, Ddaa, ddAa&lt;/td&gt;
&lt;td&gt;0.4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;DdAa&lt;/td&gt;
&lt;td&gt;0.3552&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;DDAa, DdAA&lt;/td&gt;
&lt;td&gt;0.1152&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;DDAA&lt;/td&gt;
&lt;td&gt;0.1296&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;E(XY) = &lt;span class=&#34;math inline&#34;&gt;\(0.3552 + 0.1152*2 + 0.1296*4\)&lt;/span&gt; = 1.104&lt;/p&gt;
&lt;p&gt;Cov(X,Y) = E(XY) - E(X)E(Y) = 1.104 - 0.8*0.96 = 0.336&lt;/p&gt;
&lt;p&gt;Corr(X,Y) = &lt;span class=&#34;math inline&#34;&gt;\(\frac{Cov(X,Y)}{sd(X)sd(Y)} = \frac{0.336}{0.69282*0.70654} = 0.6864\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The covariance of X and Y is 0.336 and the Correlation is 0.6864.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-7&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 7&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;Causal locus (D and d), LD locus (A and a), f(D) = 0.4, f(A|D) = 0.9, f(A|d) = 0.2. Dichotomous allele variable X: the number of D and dichotomous allele variable Y: the number of A. What is the covariance of X and Y ? (i.e. LD measure δ) and What is the Correlation? (i.e. LD measure r) (Score 10)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;f(D) = 0.4, f(d) = 0.6&lt;/p&gt;
&lt;p&gt;f(A|D) = 0.9, f(a|D) = 0.1&lt;/p&gt;
&lt;p&gt;f(A|d) = 0.2, f(a|d) = 0.8&lt;/p&gt;
&lt;p&gt;Variable X:&lt;/p&gt;
&lt;p&gt;X = 1: f(D) = 0.4&lt;/p&gt;
&lt;p&gt;X = 0: f(d) = 0.6&lt;/p&gt;
&lt;p&gt;E(X) = f(D) = 0.4&lt;/p&gt;
&lt;p&gt;Var(X) = f(D)(1-f(D)) = 0.4*0.6 = 0.24&lt;/p&gt;
&lt;p&gt;Variable Y:&lt;/p&gt;
&lt;p&gt;Y = 1: &lt;span class=&#34;math inline&#34;&gt;\(f(A) = f(A|D)f(D) + f(A|d)f(d) = 0.9*0.4 + 0.2*0.6 = 0.48\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Y = 0: &lt;span class=&#34;math inline&#34;&gt;\(f(a) = f(a|D)f(D) + f(a|d)f(d) = 0.1*0.4 + 0.8*0.6 = 0.52\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;E(Y) = f(A) = 0.48&lt;/p&gt;
&lt;p&gt;Var(Y) = f(A)(1-f(A)) = 0.48*0.52 = 0.2496&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;E(XY) = f(DA) = f(A|D)f(D) = 0.9 * 0.4 = 0.36&lt;/p&gt;
&lt;p&gt;Cov(X,Y) = E(XY) - E(X)E(Y) = 0.36 - 0.4*0.48 = 0.168&lt;/p&gt;
&lt;p&gt;Corr(X,Y = &lt;span class=&#34;math inline&#34;&gt;\(\frac{Cov(X,Y)}{\sqrt{Var(X)}\sqrt{Var(Y)}} =\frac{0.168}{\sqrt{0.24}\sqrt{0.2496}} = 0.686\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The covariance of X and Y is 0.168 and the Correlation is 0.686.&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Homework 8</title>
      <link>/post/bds751hw8/</link>
      <pubDate>Sat, 04 Apr 2020 00:00:00 +0000</pubDate>
      <guid>/post/bds751hw8/</guid>
      <description>


&lt;div id=&#34;question-1&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 1&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;
Five students independently collected their own samples and conducted a test of SNP association with hypertension. The test p-values are 0.02, 0.01, 0.03, 0.08, and 0.1. Conduct a meta-analysis and show if this SNP is significantly associated with hypertension (Score: 25) (Hints: combined p-value method)
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Method: Fisher’s combined probability test.&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(p_1 = 0.02\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(p_2 = 0.01\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(p_3 = 0.03\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(p_4 = 0.08\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(p_5 = 0.1\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(H_0\)&lt;/span&gt;: All of the separate null hypothesis(SNP is significantly with hypertension) is true.&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(H_a\)&lt;/span&gt;: At least one of the separate alternative hypothesis(SNP is not significantly associated with hypertension) is true.&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(S_F = -2\sum_{i=1}^{k}ln(p_i)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= -2(ln(p_1) + ln(p_2) + ln(p_3) + ln(p_4) + ln(p_5))\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= -2(ln(0.02) + ln(0.01) + ln(0.03) + ln(0.08) + ln(0.1))\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= -2 * (-16.852)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= 33.704\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(S_F \sim X^2_{2k}, k = 5\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(S_F\)&lt;/span&gt; follows chi-squared distribution with 10 degree of freedom, and the p-value is 0.000207 which is less than 0.05, so, we reject the null hypothesis and conclude that at least one of the test shows that SNP is not significantly associated with hypertension.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-2&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 2&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;
A locus of alleles A and a has frequency, f (A) = 0.3. If our sample contains 100 alleles, (Score: 45)
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;
a. What is the distribution of the number of allele A (NA) in the sample? and write down the probability mass function (Score: 15)
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The number of allele A is following binomial distribution.&lt;/p&gt;
&lt;p&gt;Let X = the number of allele A&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(f(X = x | p = 0.3, n = 100) = \left(\begin{matrix}100\\x\end{matrix}\right)0.3^x0.7^{100-x}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;
b. What is the expected number of NA? (Score: 15)
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(E(NA) = n(1-p) = 100 *0.7 = 70\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The expected number of NA is 70.&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;
c. What is the variance of NA? (Score: 15)
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Var(NA) = np(1-p) = 100 * 0.3 * 0.7 = 21\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The variance of NA is 21.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-3&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 3&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;
If a random variable X follows uniform distribution, X~U(-1,1), and Y=X^2, what is the covariance of X and Y? are X and Y independent? (Score: 10)
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Cov(X,Y) = E(XY) - E(X)E(Y)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= E(X^3) - E(X)E(X)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Because X follows uniform distribution,&lt;/p&gt;
&lt;p&gt;=&amp;gt; &lt;span class=&#34;math inline&#34;&gt;\(E(X) = \frac{-1+1}{2} = 0\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;=&amp;gt; &lt;span class=&#34;math inline&#34;&gt;\(E(X)E(Y) = 0\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(E(X^3) = \int_{-1}^{1}x^3dx = \frac{1}{4}x^4|_{-1}^{1} = \frac{1}{4} - \frac{1}{4} = 0\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;So, &lt;span class=&#34;math inline&#34;&gt;\(Cov(X,Y) = 0 - 0 = 0\)&lt;/span&gt;, the covariance of X and Y is 0, but X and Y are not independent, since &lt;span class=&#34;math inline&#34;&gt;\(Y = X^2\)&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-4&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 4&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;
For multinomial distribution below, show that cov(xi , xj) = −npipj. (Score 20)
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(f\left(x_1,x_2,\ldots x_n;n,p_1,p_2,\ldots,p_n\right)=\left(\begin{matrix}n\\x_1,x_2,\ldots x_n\\\end{matrix}\right)p_1^{x1}p_2^{x2}\ldots p_n^{xn}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Based on theorem, we know that &lt;span class=&#34;math inline&#34;&gt;\(x_i\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(x_j\)&lt;/span&gt; are following Binomial distribution:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(x_i \sim Binomial(n,p_i)\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(x_j \sim Binomial(n,p_j)\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(E(x_i) = np_i\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(Var(x_i) = np_i(1-p_i)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(E(x_j) = np_j\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(Var(x_j) = np_j(1-p_j)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;And &lt;span class=&#34;math inline&#34;&gt;\((x_i+x_j)\)&lt;/span&gt; also following binomial distribution.&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\((x_i + x_j) \sim Binomial(n, p_i + p_j)\)&lt;/span&gt;,&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(E(x_i+x_j) = n(p_i+p_j)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Var(x_i+x_j) = n(p_i+p_j)(1-p_i-p_j)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Cov(x_i,x_j) = \frac{1}{2}[Var(x_i + x_j)-Var(x_i)-Var(x_j)]\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= \frac{1}{2}[n(p_i+p_j)(1-p_i-p_j) -np_i(1-p_i) - np_j(1-p_j)]\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= \frac{1}{2}(-2np_ip_j)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= -np_ip_j\)&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Homework 4</title>
      <link>/post/bds723hw4/</link>
      <pubDate>Sun, 15 Mar 2020 15:02:32 -0500</pubDate>
      <guid>/post/bds723hw4/</guid>
      <description>


&lt;div id=&#34;question-1&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 1&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;For a cell in meiosis interphase, how many chromosomes and chromatids are there in G1? and how many in G2? (Score: 5)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;G1: 46 chromosomes, 0 chromatids.&lt;/p&gt;
&lt;p&gt;G2: 46 chromosomes, 92 chromatids.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-2&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 2&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;How many daughter cells will be for a cell after meiosis I? and how many chromosomes and chromatids are there for each daughter cell? (Score: 5)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;2 daughter cells after meiosis I.&lt;/p&gt;
&lt;p&gt;23 chromosomes and 46 chromotids.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-3&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 3&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;How many daughter cells will be for a cell after meiosis II? And how many chromosomes and chromatids are there for each daughter cell? (Score: 5)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Four daughter cells.&lt;/p&gt;
&lt;p&gt;23 chromosomes and 0 chromotids.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-4&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 4&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;Recombination can be seen as chiasmata between homologous chromosomes at what stage of cell division? (Score: 5)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Metaphase I at Meiosis I.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-5&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 5&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;Is it possible for meiosis to occur in a haploid cell? (Score: 5) Extra credit: Is mitosis possible? (Score: 5)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;No. Meiosis requires even number of chromosomes. And Mitosis could happen in a haploid cell.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-6&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 6&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;For two loci with genotypes of Aa and Bb, which one of the following could happen: segregation without independent assortment; or independent assortment without segregation? (Score: 5)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Segregation without independent assortment could happen.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-7&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 7&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;If an individual has alleles of A and a in a locus, what types of gamete can be made? and what is the probability for each type of gamete? (Score: 5) &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Two possiable gametes: A and a.&lt;/p&gt;
&lt;p&gt;Pr(A) = 0.5 and Pr(a) = 0.5&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-8&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 8&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;If an individual has alleles of A and a at a locus of chr 1, but only allele B at a locus of chr 2, what types of gamete can be made? and what is the probability for each type of gamete? (Score: 5)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Two possiable gametes: AB and aB.&lt;/p&gt;
&lt;p&gt;Pr(AB) = 0.5 and Pr(aB) = 0.5&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-9&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 9&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;If an individual has alleles of A and a at a locus of chr 1, and alleles of B and b at a locus of chr 2, what types of gamete can be made? and what is the probability for each type of gamete? (Score: 5) &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Four possiable gametes: AB, aB, Ab, ab.&lt;/p&gt;
&lt;p&gt;Pr(AB) = Pr(aB) = Pr(Ab) = Pr(ab) = 0.25&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-10&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 10&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;How many different kinds of gametes can be produced by an individual who carries heterozygotic alleles at three loci of different chromosomes (e.g. Aa of locus 1 at chr 1, Bb of locus 2 at chr 2 and Cc of locus 3 at chr 3)? (Score: 5) &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(2^3 = 8\)&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-11&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 11&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;If an individual has heterozygous genotypes at each of 6 loci, how many types of gametes can be produced under assumption of independent assortment? (Score: 5) &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(2^6 = 64\)&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-12&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 12&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;If both parents have genotypes of Aa, what genotypes can be observed for their kid and what their probabilities are? (Score: 5)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Genotypes: AA. Aa, aa&lt;/p&gt;
&lt;p&gt;Pr(AA) = Pr(aa) = 0.25 and Pr(Aa) = 0.5&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-13&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 13&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;Father has genotype of AaBB and mother has genotype of Aabb. With independent assortment for all loci, what genotypes can be observed for their kid and what their probabilities? (Score: 5) &lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-14&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 14&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;&lt;/span&gt;
## &lt;span style=&#34;color:red&#34;&gt;Question 15&lt;/span&gt;
&lt;span style=&#34;color:orange&#34;&gt;&lt;/span&gt;
## &lt;span style=&#34;color:red&#34;&gt;Question 16&lt;/span&gt;
&lt;span style=&#34;color:orange&#34;&gt;&lt;/span&gt;
## &lt;span style=&#34;color:red&#34;&gt;Question 17&lt;/span&gt;
&lt;span style=&#34;color:orange&#34;&gt;&lt;/span&gt;
## &lt;span style=&#34;color:red&#34;&gt;Question 18&lt;/span&gt;
&lt;span style=&#34;color:orange&#34;&gt;&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Bds723 Tidy Data</title>
      <link>/post/bds723-tidy-data/</link>
      <pubDate>Tue, 10 Mar 2020 23:19:54 -0500</pubDate>
      <guid>/post/bds723-tidy-data/</guid>
      <description>


&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## ── Attaching packages ──── tidyverse 1.3.0 ──&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## ✓ ggplot2 3.2.1     ✓ purrr   0.3.3
## ✓ tibble  2.1.3     ✓ dplyr   0.8.3
## ✓ tidyr   1.0.2     ✓ stringr 1.4.0
## ✓ readr   1.3.1     ✓ forcats 0.4.0&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## ── Conflicts ─────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(tidyr)&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;dataset-who&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Dataset: WHO&lt;/h1&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;mydata &amp;lt;- who
mydata&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 7,240 x 60
##    country iso2  iso3   year new_sp_m014 new_sp_m1524 new_sp_m2534 new_sp_m3544
##    &amp;lt;chr&amp;gt;   &amp;lt;chr&amp;gt; &amp;lt;chr&amp;gt; &amp;lt;int&amp;gt;       &amp;lt;int&amp;gt;        &amp;lt;int&amp;gt;        &amp;lt;int&amp;gt;        &amp;lt;int&amp;gt;
##  1 Afghan… AF    AFG    1980          NA           NA           NA           NA
##  2 Afghan… AF    AFG    1981          NA           NA           NA           NA
##  3 Afghan… AF    AFG    1982          NA           NA           NA           NA
##  4 Afghan… AF    AFG    1983          NA           NA           NA           NA
##  5 Afghan… AF    AFG    1984          NA           NA           NA           NA
##  6 Afghan… AF    AFG    1985          NA           NA           NA           NA
##  7 Afghan… AF    AFG    1986          NA           NA           NA           NA
##  8 Afghan… AF    AFG    1987          NA           NA           NA           NA
##  9 Afghan… AF    AFG    1988          NA           NA           NA           NA
## 10 Afghan… AF    AFG    1989          NA           NA           NA           NA
## # … with 7,230 more rows, and 52 more variables: new_sp_m4554 &amp;lt;int&amp;gt;,
## #   new_sp_m5564 &amp;lt;int&amp;gt;, new_sp_m65 &amp;lt;int&amp;gt;, new_sp_f014 &amp;lt;int&amp;gt;,
## #   new_sp_f1524 &amp;lt;int&amp;gt;, new_sp_f2534 &amp;lt;int&amp;gt;, new_sp_f3544 &amp;lt;int&amp;gt;,
## #   new_sp_f4554 &amp;lt;int&amp;gt;, new_sp_f5564 &amp;lt;int&amp;gt;, new_sp_f65 &amp;lt;int&amp;gt;,
## #   new_sn_m014 &amp;lt;int&amp;gt;, new_sn_m1524 &amp;lt;int&amp;gt;, new_sn_m2534 &amp;lt;int&amp;gt;,
## #   new_sn_m3544 &amp;lt;int&amp;gt;, new_sn_m4554 &amp;lt;int&amp;gt;, new_sn_m5564 &amp;lt;int&amp;gt;,
## #   new_sn_m65 &amp;lt;int&amp;gt;, new_sn_f014 &amp;lt;int&amp;gt;, new_sn_f1524 &amp;lt;int&amp;gt;,
## #   new_sn_f2534 &amp;lt;int&amp;gt;, new_sn_f3544 &amp;lt;int&amp;gt;, new_sn_f4554 &amp;lt;int&amp;gt;,
## #   new_sn_f5564 &amp;lt;int&amp;gt;, new_sn_f65 &amp;lt;int&amp;gt;, new_ep_m014 &amp;lt;int&amp;gt;,
## #   new_ep_m1524 &amp;lt;int&amp;gt;, new_ep_m2534 &amp;lt;int&amp;gt;, new_ep_m3544 &amp;lt;int&amp;gt;,
## #   new_ep_m4554 &amp;lt;int&amp;gt;, new_ep_m5564 &amp;lt;int&amp;gt;, new_ep_m65 &amp;lt;int&amp;gt;,
## #   new_ep_f014 &amp;lt;int&amp;gt;, new_ep_f1524 &amp;lt;int&amp;gt;, new_ep_f2534 &amp;lt;int&amp;gt;,
## #   new_ep_f3544 &amp;lt;int&amp;gt;, new_ep_f4554 &amp;lt;int&amp;gt;, new_ep_f5564 &amp;lt;int&amp;gt;,
## #   new_ep_f65 &amp;lt;int&amp;gt;, newrel_m014 &amp;lt;int&amp;gt;, newrel_m1524 &amp;lt;int&amp;gt;,
## #   newrel_m2534 &amp;lt;int&amp;gt;, newrel_m3544 &amp;lt;int&amp;gt;, newrel_m4554 &amp;lt;int&amp;gt;,
## #   newrel_m5564 &amp;lt;int&amp;gt;, newrel_m65 &amp;lt;int&amp;gt;, newrel_f014 &amp;lt;int&amp;gt;,
## #   newrel_f1524 &amp;lt;int&amp;gt;, newrel_f2534 &amp;lt;int&amp;gt;, newrel_f3544 &amp;lt;int&amp;gt;,
## #   newrel_f4554 &amp;lt;int&amp;gt;, newrel_f5564 &amp;lt;int&amp;gt;, newrel_f65 &amp;lt;int&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;glimpse(mydata)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Observations: 7,240
## Variables: 60
## $ country      &amp;lt;chr&amp;gt; &amp;quot;Afghanistan&amp;quot;, &amp;quot;Afghanistan&amp;quot;, &amp;quot;Afghanistan&amp;quot;, &amp;quot;Afghanista…
## $ iso2         &amp;lt;chr&amp;gt; &amp;quot;AF&amp;quot;, &amp;quot;AF&amp;quot;, &amp;quot;AF&amp;quot;, &amp;quot;AF&amp;quot;, &amp;quot;AF&amp;quot;, &amp;quot;AF&amp;quot;, &amp;quot;AF&amp;quot;, &amp;quot;AF&amp;quot;, &amp;quot;AF&amp;quot;, &amp;quot;A…
## $ iso3         &amp;lt;chr&amp;gt; &amp;quot;AFG&amp;quot;, &amp;quot;AFG&amp;quot;, &amp;quot;AFG&amp;quot;, &amp;quot;AFG&amp;quot;, &amp;quot;AFG&amp;quot;, &amp;quot;AFG&amp;quot;, &amp;quot;AFG&amp;quot;, &amp;quot;AFG&amp;quot;, …
## $ year         &amp;lt;int&amp;gt; 1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 19…
## $ new_sp_m014  &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_sp_m1524 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_sp_m2534 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_sp_m3544 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_sp_m4554 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_sp_m5564 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_sp_m65   &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_sp_f014  &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_sp_f1524 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_sp_f2534 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_sp_f3544 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_sp_f4554 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_sp_f5564 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_sp_f65   &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_sn_m014  &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_sn_m1524 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_sn_m2534 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_sn_m3544 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_sn_m4554 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_sn_m5564 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_sn_m65   &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_sn_f014  &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_sn_f1524 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_sn_f2534 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_sn_f3544 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_sn_f4554 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_sn_f5564 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_sn_f65   &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_ep_m014  &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_ep_m1524 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_ep_m2534 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_ep_m3544 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_ep_m4554 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_ep_m5564 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_ep_m65   &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_ep_f014  &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_ep_f1524 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_ep_f2534 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_ep_f3544 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_ep_f4554 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_ep_f5564 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ new_ep_f65   &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ newrel_m014  &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ newrel_m1524 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ newrel_m2534 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ newrel_m3544 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ newrel_m4554 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ newrel_m5564 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ newrel_m65   &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ newrel_f014  &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ newrel_f1524 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ newrel_f2534 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ newrel_f3544 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ newrel_f4554 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ newrel_f5564 &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
## $ newrel_f65   &amp;lt;int&amp;gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;colnames(mydata)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##  [1] &amp;quot;country&amp;quot;      &amp;quot;iso2&amp;quot;         &amp;quot;iso3&amp;quot;         &amp;quot;year&amp;quot;         &amp;quot;new_sp_m014&amp;quot; 
##  [6] &amp;quot;new_sp_m1524&amp;quot; &amp;quot;new_sp_m2534&amp;quot; &amp;quot;new_sp_m3544&amp;quot; &amp;quot;new_sp_m4554&amp;quot; &amp;quot;new_sp_m5564&amp;quot;
## [11] &amp;quot;new_sp_m65&amp;quot;   &amp;quot;new_sp_f014&amp;quot;  &amp;quot;new_sp_f1524&amp;quot; &amp;quot;new_sp_f2534&amp;quot; &amp;quot;new_sp_f3544&amp;quot;
## [16] &amp;quot;new_sp_f4554&amp;quot; &amp;quot;new_sp_f5564&amp;quot; &amp;quot;new_sp_f65&amp;quot;   &amp;quot;new_sn_m014&amp;quot;  &amp;quot;new_sn_m1524&amp;quot;
## [21] &amp;quot;new_sn_m2534&amp;quot; &amp;quot;new_sn_m3544&amp;quot; &amp;quot;new_sn_m4554&amp;quot; &amp;quot;new_sn_m5564&amp;quot; &amp;quot;new_sn_m65&amp;quot;  
## [26] &amp;quot;new_sn_f014&amp;quot;  &amp;quot;new_sn_f1524&amp;quot; &amp;quot;new_sn_f2534&amp;quot; &amp;quot;new_sn_f3544&amp;quot; &amp;quot;new_sn_f4554&amp;quot;
## [31] &amp;quot;new_sn_f5564&amp;quot; &amp;quot;new_sn_f65&amp;quot;   &amp;quot;new_ep_m014&amp;quot;  &amp;quot;new_ep_m1524&amp;quot; &amp;quot;new_ep_m2534&amp;quot;
## [36] &amp;quot;new_ep_m3544&amp;quot; &amp;quot;new_ep_m4554&amp;quot; &amp;quot;new_ep_m5564&amp;quot; &amp;quot;new_ep_m65&amp;quot;   &amp;quot;new_ep_f014&amp;quot; 
## [41] &amp;quot;new_ep_f1524&amp;quot; &amp;quot;new_ep_f2534&amp;quot; &amp;quot;new_ep_f3544&amp;quot; &amp;quot;new_ep_f4554&amp;quot; &amp;quot;new_ep_f5564&amp;quot;
## [46] &amp;quot;new_ep_f65&amp;quot;   &amp;quot;newrel_m014&amp;quot;  &amp;quot;newrel_m1524&amp;quot; &amp;quot;newrel_m2534&amp;quot; &amp;quot;newrel_m3544&amp;quot;
## [51] &amp;quot;newrel_m4554&amp;quot; &amp;quot;newrel_m5564&amp;quot; &amp;quot;newrel_m65&amp;quot;   &amp;quot;newrel_f014&amp;quot;  &amp;quot;newrel_f1524&amp;quot;
## [56] &amp;quot;newrel_f2534&amp;quot; &amp;quot;newrel_f3544&amp;quot; &amp;quot;newrel_f4554&amp;quot; &amp;quot;newrel_f5564&amp;quot; &amp;quot;newrel_f65&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# combine all the TB cases columns
mydata&amp;lt;-mydata %&amp;gt;%
  pivot_longer(cols = new_sp_m014:newrel_f65,names_to = &amp;quot;cases&amp;quot;,values_to = &amp;quot;value&amp;quot;)
mydata&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 405,440 x 6
##    country     iso2  iso3   year cases        value
##    &amp;lt;chr&amp;gt;       &amp;lt;chr&amp;gt; &amp;lt;chr&amp;gt; &amp;lt;int&amp;gt; &amp;lt;chr&amp;gt;        &amp;lt;int&amp;gt;
##  1 Afghanistan AF    AFG    1980 new_sp_m014     NA
##  2 Afghanistan AF    AFG    1980 new_sp_m1524    NA
##  3 Afghanistan AF    AFG    1980 new_sp_m2534    NA
##  4 Afghanistan AF    AFG    1980 new_sp_m3544    NA
##  5 Afghanistan AF    AFG    1980 new_sp_m4554    NA
##  6 Afghanistan AF    AFG    1980 new_sp_m5564    NA
##  7 Afghanistan AF    AFG    1980 new_sp_m65      NA
##  8 Afghanistan AF    AFG    1980 new_sp_f014     NA
##  9 Afghanistan AF    AFG    1980 new_sp_f1524    NA
## 10 Afghanistan AF    AFG    1980 new_sp_f2534    NA
## # … with 405,430 more rows&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# change &amp;quot;newrel&amp;quot; to &amp;quot;new_rel&amp;quot; to match the pattern
mydata &amp;lt;- mydata %&amp;gt;%
  mutate(cases = str_replace(cases, pattern = &amp;quot;newr&amp;quot;, replacement = &amp;quot;new_r&amp;quot;)) %&amp;gt;%
  separate(col = cases, into=c(&amp;quot;new&amp;quot;,&amp;quot;diagnosis&amp;quot;,&amp;quot;gender&amp;quot;), sep=&amp;quot;_&amp;quot;)
mydata&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 405,440 x 8
##    country     iso2  iso3   year new   diagnosis gender value
##    &amp;lt;chr&amp;gt;       &amp;lt;chr&amp;gt; &amp;lt;chr&amp;gt; &amp;lt;int&amp;gt; &amp;lt;chr&amp;gt; &amp;lt;chr&amp;gt;     &amp;lt;chr&amp;gt;  &amp;lt;int&amp;gt;
##  1 Afghanistan AF    AFG    1980 new   sp        m014      NA
##  2 Afghanistan AF    AFG    1980 new   sp        m1524     NA
##  3 Afghanistan AF    AFG    1980 new   sp        m2534     NA
##  4 Afghanistan AF    AFG    1980 new   sp        m3544     NA
##  5 Afghanistan AF    AFG    1980 new   sp        m4554     NA
##  6 Afghanistan AF    AFG    1980 new   sp        m5564     NA
##  7 Afghanistan AF    AFG    1980 new   sp        m65       NA
##  8 Afghanistan AF    AFG    1980 new   sp        f014      NA
##  9 Afghanistan AF    AFG    1980 new   sp        f1524     NA
## 10 Afghanistan AF    AFG    1980 new   sp        f2534     NA
## # … with 405,430 more rows&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;mydata&amp;lt;-mydata %&amp;gt;%
  separate(col=gender,into= c(&amp;quot;gender&amp;quot;,&amp;quot;age&amp;quot;),sep = 1)
mydata&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 405,440 x 9
##    country     iso2  iso3   year new   diagnosis gender age   value
##    &amp;lt;chr&amp;gt;       &amp;lt;chr&amp;gt; &amp;lt;chr&amp;gt; &amp;lt;int&amp;gt; &amp;lt;chr&amp;gt; &amp;lt;chr&amp;gt;     &amp;lt;chr&amp;gt;  &amp;lt;chr&amp;gt; &amp;lt;int&amp;gt;
##  1 Afghanistan AF    AFG    1980 new   sp        m      014      NA
##  2 Afghanistan AF    AFG    1980 new   sp        m      1524     NA
##  3 Afghanistan AF    AFG    1980 new   sp        m      2534     NA
##  4 Afghanistan AF    AFG    1980 new   sp        m      3544     NA
##  5 Afghanistan AF    AFG    1980 new   sp        m      4554     NA
##  6 Afghanistan AF    AFG    1980 new   sp        m      5564     NA
##  7 Afghanistan AF    AFG    1980 new   sp        m      65       NA
##  8 Afghanistan AF    AFG    1980 new   sp        f      014      NA
##  9 Afghanistan AF    AFG    1980 new   sp        f      1524     NA
## 10 Afghanistan AF    AFG    1980 new   sp        f      2534     NA
## # … with 405,430 more rows&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# change age to factor var
mydata$age %&amp;gt;% unique()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;014&amp;quot;  &amp;quot;1524&amp;quot; &amp;quot;2534&amp;quot; &amp;quot;3544&amp;quot; &amp;quot;4554&amp;quot; &amp;quot;5564&amp;quot; &amp;quot;65&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;mydata&amp;lt;-mydata %&amp;gt;%
  mutate(
    age = recode_factor(
      age,
      &amp;quot;014&amp;quot; = &amp;quot;0-14&amp;quot;,
      &amp;quot;1524&amp;quot; = &amp;quot;15-24&amp;quot;,
      &amp;quot;2534&amp;quot; = &amp;quot;25-34&amp;quot;,
      &amp;quot;3544&amp;quot; = &amp;quot;35-44&amp;quot;,
      &amp;quot;4554&amp;quot; = &amp;quot;45-54&amp;quot;,
      &amp;quot;5564&amp;quot; = &amp;quot;55-64&amp;quot;,
      &amp;quot;65&amp;quot; = &amp;quot;65 and above&amp;quot;
    )
  )
mydata&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 405,440 x 9
##    country     iso2  iso3   year new   diagnosis gender age          value
##    &amp;lt;chr&amp;gt;       &amp;lt;chr&amp;gt; &amp;lt;chr&amp;gt; &amp;lt;int&amp;gt; &amp;lt;chr&amp;gt; &amp;lt;chr&amp;gt;     &amp;lt;chr&amp;gt;  &amp;lt;fct&amp;gt;        &amp;lt;int&amp;gt;
##  1 Afghanistan AF    AFG    1980 new   sp        m      0-14            NA
##  2 Afghanistan AF    AFG    1980 new   sp        m      15-24           NA
##  3 Afghanistan AF    AFG    1980 new   sp        m      25-34           NA
##  4 Afghanistan AF    AFG    1980 new   sp        m      35-44           NA
##  5 Afghanistan AF    AFG    1980 new   sp        m      45-54           NA
##  6 Afghanistan AF    AFG    1980 new   sp        m      55-64           NA
##  7 Afghanistan AF    AFG    1980 new   sp        m      65 and above    NA
##  8 Afghanistan AF    AFG    1980 new   sp        f      0-14            NA
##  9 Afghanistan AF    AFG    1980 new   sp        f      15-24           NA
## 10 Afghanistan AF    AFG    1980 new   sp        f      25-34           NA
## # … with 405,430 more rows&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# remove new
mydata&amp;lt;-mydata %&amp;gt;% select(-new)&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# factor variable
mydata &amp;lt;- mydata %&amp;gt;%
  mutate(gender = parse_factor(gender, levels = c(&amp;quot;f&amp;quot;,&amp;quot;m&amp;quot;)),
         diagnosis = parse_factor(diagnosis)) %&amp;gt;%
  rename(cases = value)
mydata&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 405,440 x 8
##    country     iso2  iso3   year diagnosis gender age          cases
##    &amp;lt;chr&amp;gt;       &amp;lt;chr&amp;gt; &amp;lt;chr&amp;gt; &amp;lt;int&amp;gt; &amp;lt;fct&amp;gt;     &amp;lt;fct&amp;gt;  &amp;lt;fct&amp;gt;        &amp;lt;int&amp;gt;
##  1 Afghanistan AF    AFG    1980 sp        m      0-14            NA
##  2 Afghanistan AF    AFG    1980 sp        m      15-24           NA
##  3 Afghanistan AF    AFG    1980 sp        m      25-34           NA
##  4 Afghanistan AF    AFG    1980 sp        m      35-44           NA
##  5 Afghanistan AF    AFG    1980 sp        m      45-54           NA
##  6 Afghanistan AF    AFG    1980 sp        m      55-64           NA
##  7 Afghanistan AF    AFG    1980 sp        m      65 and above    NA
##  8 Afghanistan AF    AFG    1980 sp        f      0-14            NA
##  9 Afghanistan AF    AFG    1980 sp        f      15-24           NA
## 10 Afghanistan AF    AFG    1980 sp        f      25-34           NA
## # … with 405,430 more rows&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Note13 Kernel</title>
      <link>/post/note13-kernel/</link>
      <pubDate>Mon, 09 Mar 2020 13:58:30 -0500</pubDate>
      <guid>/post/note13-kernel/</guid>
      <description>



</description>
    </item>
    
    <item>
      <title>Homework 7</title>
      <link>/post/bds751hw7/</link>
      <pubDate>Thu, 05 Mar 2020 00:00:00 +0000</pubDate>
      <guid>/post/bds751hw7/</guid>
      <description>


&lt;div id=&#34;question-1&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 1&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;
Suppose disease locus (alleles D and d) and LD locus (alleles A and a) with Pr(A|D) = 0.9, Pr(A|d) = 0.2 and f (D) = 0.4. Calculate allele distribution of LD locus (i.e. f (A) =? And f (a) =?)
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;f(A) = f(A,D) + f(A,d) = Pr(A|D)f(D) + Pr(A|d)f(d)&lt;/p&gt;
&lt;p&gt;f(D) = 0.4 &lt;span class=&#34;math inline&#34;&gt;\(=&amp;gt;\)&lt;/span&gt; f(d) = 0.6&lt;/p&gt;
&lt;p&gt;Pr(A|D) = 0.9, Pr(A|d) = 0.2&lt;/p&gt;
&lt;p&gt;f(A) = &lt;span class=&#34;math inline&#34;&gt;\(0.9*0.4 + 0.2*0.6 = 0.48\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;f(a) = 1 - f(A) = 1 - 0.48 = 0.52&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;
a. set Pr(A|D)=p1, Pr(A|d)=p2 and f(D)=q, write down the inference formula for LD allele frequencies (i.e. f(A) and f(a)), based on parameters of p1, p2 and q (score 15)
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;f(A) = f(A,D) + f(A,d) = Pr(A|D)f(D) + Pr(A|d)f(d)&lt;/p&gt;
&lt;p&gt;f(D) = q &lt;span class=&#34;math inline&#34;&gt;\(=&amp;gt;\)&lt;/span&gt; f(d) = 1-q&lt;/p&gt;
&lt;p&gt;f(A) = &lt;span class=&#34;math inline&#34;&gt;\(p_1*q + p_2*(1-q)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;f(a) = 1 - f(A) = &lt;span class=&#34;math inline&#34;&gt;\(1 - p_1*q - p_2*(1-q)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;
b. Extra credit: implements getAlleleFreq function using the template of lecture slide (score 5)
&lt;/span&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;getAlleleFreq &amp;lt;- function(p1,p2,q){
  fA = p1*q + p2*(1-q)
  fa = 1 - fA
  return(c(fA=fA,fa=fa))
}&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;getAlleleFreq(0.9,0.2,0.4)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   fA   fa 
## 0.48 0.52&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;question-2&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 2&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;
Suppose disease locus (alleles D and d) and LD locus (alleles A and a) with Pr(A|D) = 0.9, Pr(A|d) = 0.2 and f (D) = 0.4.
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;
a. Construct contingency table for the joint genotype distribution of disease and LD locus (score 25)
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(DD) = 0.4*0.4 = 0.16\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Dd) = 2*0.4*0.6 = 0.48\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(dd) = 0.6*0.6 = 0.36\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(a|D) = 1 - Pr(A|D) = 1 - 0.9 = 0.1\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(a|d) = 1 - Pr(A|d) = 1 - 0.2 = 0.8\)&lt;/span&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(AA,DD) = Pr(AA|DD)Pr(DD) = Pr(A|D)^2Pr(DD) = 0.9^2*0.16 = 0.1296\)&lt;/span&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(AA,Dd) = Pr(AA,D_md_f) + Pr(AA,D_fd_m)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(AA|D_md_f)Pr(D_md_f) + Pr(AA|D_fd_m)Pr(D_fd_m)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(A|D_m)Pr(A|d_f)Pr(D_md_f) + Pr(A|D_f)Pr(A|d_m)Pr(D_fd_m)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(A|D)Pr(A|d)Pr(D_md_f) + Pr(A|D)Pr(A|d)Pr(D_fd_m)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(A|D)Pr(A|d)[Pr(D_md_f) + Pr(D_fd_m)]\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(A|D)Pr(A|d)Pr(Dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= 0.9*0.2*0.48 = 0.0864\)&lt;/span&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(AA,dd) = Pr(AA|dd)Pr(dd) = Pr(A|d)^2Pr(dd) = 0.2^2*0.36 = 0.0144\)&lt;/span&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Aa,DD) = Pr(A_ma_f,DD) + Pr(A_fa_m,DD)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(A_ma_f|DD)Pr(DD) + Pr(A_fa_m|DD)Pr(DD)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(A_m|D)Pr(a_f|D)Pr(DD) + Pr(A_f|D)Pr(a_m|D)Pr(DD)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(A|D)Pr(a|D)Pr(DD) + Pr(A|D)Pr(a|D)Pr(DD)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= 2Pr(A|D)Pr(a|D)Pr(DD)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= 2*0.9*0.1*0.16 = 0.0288\)&lt;/span&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Aa,Dd) = Pr(A_ma_f,D_md_f) + Pr(A_ma_f,D_fd_m) + Pr(A_fa_m,D_md_f) + Pr(A_fa_m,D_fd_m)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(A_ma_f|D_md_f)Pr(D_md_f) + Pr(A_ma_f|D_fd_m)Pr(D_fd_m) + Pr(A_fa_m|D_md_f)Pr(D_md_f) + Pr(A_fa_m|D_fd_m)Pr(D_fd_m)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(A_m|D_m)Pr(a_f|d_f)Pr(D_md_f) + Pr(A_m|d_m)Pr(a_f|D_f)Pr(D_fd_m) + Pr(A_f|d_f)Pr(a_m|D_m)Pr(D_md_f) + Pr(A_f|D_f)Pr(a_m|d_m)Pr(D_fd_m)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(A|D)Pr(a|d)Pr(D_md_f) + Pr(A|d)Pr(a|D)Pr(D_fd_m) + Pr(A|d)Pr(a|D)Pr(D_md_f) + Pr(A|D)Pr(a|d)Pr(D_fd_m)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(A|D)Pr(a|d)[Pr(D_md_f)+Pr(D_fd_m)] + Pr(A|d)Pr(a|D)[Pr(D_fd_m)+Pr(D_md_f)]\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(A|D)Pr(a|d)Pr(Dd) + Pr(A|d)Pr(a|D)Pr(Dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= 0.9*0.8*0.48+0.2*0.1*0.48 = 0.3552\)&lt;/span&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Aa,dd) = Pr(A_ma_f,dd) + Pr(A_fa_m,dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(A_ma_f|dd)Pr(dd) + Pr(A_fa_m|dd)Pr(dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(A_m|d)Pr(a_f|d)Pr(dd) + Pr(A_f|d)Pr(a_m|d)Pr(dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(A|d)Pr(a|d)Pr(dd) + Pr(A|d)Pr(a|d)Pr(dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= 2Pr(A|d)Pr(a|d)Pr(dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= 2*0.2*0.8*0.36 = 0.1152\)&lt;/span&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(aa,DD) = Pr(aa|DD)Pr(DD) = Pr(a|D)^2Pr(DD)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= 0.1^2*0.16 = 0.0016\)&lt;/span&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(aa,Dd) = Pr(aa,D_md_f) + Pr(aa,D_fd_m)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(aa|D_md_f)Pr(D_md_f) + Pr(aa|D_fd_m)Pr(D_fd_m)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(a|D_m)Pr(a|d_f)Pr(D_md_f) + Pr(a|D_f)Pr(a|d_m)Pr(D_fd_m)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(a|D)Pr(a|d)Pr(D_md_f) + Pr(a|D)Pr(a|d)Pr(D_fd_m)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(a|D)Pr(a|d)[Pr(D_md_f)+Pr(D_fd_m)]\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(a|D)Pr(a|d)Pr(Dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= 0.1*0.8*0.48 = 0.0384\)&lt;/span&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(aa,dd) = Pr(aa|dd)Pr(dd) = Pr(a|d)^2Pr(dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= 0.8^2*0.36 = 0.2304\)&lt;/span&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th&gt;```&lt;/th&gt;
&lt;th&gt;AA&lt;/th&gt;
&lt;th&gt;Aa&lt;/th&gt;
&lt;th&gt;aa&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;DD&lt;/td&gt;
&lt;td&gt;0.1296&lt;/td&gt;
&lt;td&gt;0.0288&lt;/td&gt;
&lt;td&gt;0.0016&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;Dd&lt;/td&gt;
&lt;td&gt;0.0864&lt;/td&gt;
&lt;td&gt;0.3552&lt;/td&gt;
&lt;td&gt;0.0384&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;dd&lt;/td&gt;
&lt;td&gt;0.0144&lt;/td&gt;
&lt;td&gt;0.1152&lt;/td&gt;
&lt;td&gt;0.2304&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;
b. Calculate genotype distribution of the LD locus (i.e. f(AA), f(Aa) and f(aa)), based on the contingency table (score 10)
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(AA) = Pr(AA,DD) + Pr(AA,Dd) + Pr(AA,dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= 0.1296 + 0.0864 + 0.0144 = 0.2304\)&lt;/span&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Aa) = Pr(Aa,DD) + Pr(Aa,Dd) + Pr(Aa,dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= 0.0288 + 0.3552 + 0.1152 = 0.4992\)&lt;/span&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(aa) = Pr(aa,DD) + Pr(aa,Dd) + Pr(aa,dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= 0.0016 + 0.0384 + 0.2304 = 0.2704\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;
c. Is LD locus in HWE? (score 10)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Yes. Because &lt;span class=&#34;math inline&#34;&gt;\(Pr(AA) = Pr(A)^2, Pr(Aa) = 2Pr(A)Pr(a), Pr(aa) = Pr(a)^2\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;
d. set Pr(A|D)=p1, Pr(A|d)=p2 and f(D)=q, write down the inference formula for LD genotype frequencies (i.e. f(AA), f(Aa) and f(aa)), based on parameters of p1, p2 and q. (score 10)
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(AA) = Pr(AA,DD) + Pr(AA,Dd) + Pr(AA,dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(AA|DD)Pr(DD) + Pr(AA|Dd)Pr(Dd) + Pr(AA|dd)Pr(dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(A|D)^2Pr(DD) + Pr(A|D)Pr(A|d)Pr(Dd) + Pr(A|d)^2Pr(dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= p_1^2q^2 + p_1p_22q(1-q) + p_2^2(1-q)^2\)&lt;/span&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Aa) = Pr(Aa,DD) + Pr(Aa,Dd) + Pr(Aa,dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(Aa|DD)Pr(DD) + Pr(Aa|Dd)Pr(Dd) + Pr(Aa|dd)Pr(dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= 2Pr(A|D)Pr(a|D)Pr(DD) + Pr(Dd)[Pr(A|D)Pr(a|d) + Pr(A|d)Pr(a|D] + 2Pr(A|d)Pr(a|d)Pr(dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= 2p_1(1-p_1)q^2 + 2q(1-q)[p_1(1-p_2)+p_2(1-p_1)] + 2p_2(1-p_2)(1-q)^2\)&lt;/span&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(aa) = Pr(aa,DD) + Pr(aa,Dd) + Pr(aa,dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(aa|DD)Pr(DD) + Pr(aa|Dd)Pr(Dd) + Pr(aa|dd)Pr(dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(a|D)^2Pr(DD) + Pr(a|D)Pr(a|d)Pr(Dd) + Pr(a|d)^2Pr(dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= (1-p_1)^2q^2 + (1-p_1)(1-p_2)2q(1-q) + (1-p_2)^2(1-q)^2\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;
e. Extra credit: implements getGenotypeFreq function using the template of lecture slide (score 10)
&lt;/span&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;getGenotypeFreq &amp;lt;- function(p1,p2,q){
  fAA = (p1^2)*(q^2) + p1*p2*2*q*(1-q) + (p2^2)*((1-q)^2)
  fAa = 2*p1*(1-p1)*(q^2) + 2*q*(1-q)*(p1*(1-p2)+p2*(1-p1)) + 2*p2*(1-p2)*((1-q)^2)
  faa = ((1-p1)^2)*(q^2) + (1-p1)*(1-p2)*2*q*(1-q) + ((1-p2)^2)*((1-q)^2)
  return(c(fAA=fAA,fAa=fAa, faa = faa))
}

getGenotypeFreq(0.9,0.2,0.4)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##    fAA    fAa    faa 
## 0.2304 0.4992 0.2704&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;question-3&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 3&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;
Suppose disease locus (alleles D and d) and LD locus (alleles A and a) with Pr(A|D) = 0.9, Pr(A|d) = 0.2 and f (D) = 0.4. If penetrance of disease locus G1 is: Pr(Y = 1|G1 = DD) = 0.8, Pr(Y = 1|G1 = Dd) = 0.4, and Pr(Y = 1|G1 = dd) = 0.2, what the penetrance of LD locus G2 will be? (score 30)
&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;q3.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y|G_2=AA) = Pr(Y|G_2=Aa) = Pr(Y|G_2=aa) = Pr(Y)\)&lt;/span&gt; Due to &lt;span class=&#34;math inline&#34;&gt;\(G_2\)&lt;/span&gt; is independent with Y.&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(DD) = Pr(D)^2 = 0.4^2 = 0.16\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Dd) = 2Pr(D)Pr(d) = 2*0.4*0.6 = 0.48\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(dd) = Pr(d)^2 = 0.6^2 = 0.36\)&lt;/span&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y=1) = Pr(Y=1, G_1=DD)+Pr(Y=1, G_1=Dd)+Pr(Y=1, G_1=dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(Y=1|DD)Pr(DD)+Pr(Y=1|Dd)Pr(Dd)+Pr(Y=1|dd)Pr(dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= 0.8*0.16 + 0.4*0.48 + 0.2*0.36 = 0.392\)&lt;/span&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y=0) = Pr(Y=0, G_1=DD)+Pr(Y=0, G_1=Dd)+Pr(Y=0, G_1=dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(Y=0|DD)Pr(DD)+Pr(Y=0|Dd)Pr(Dd)+Pr(Y=0|dd)Pr(dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= [1-Pr(Y=1|DD)]Pr(DD)+[1-Pr(Y=1|Dd)]Pr(Dd)+[1-Pr(Y=1|dd)]Pr(dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= (1-0.8)*0.16 + (1-0.4)*0.48 + (1-0.2)*0.36 = 0.608\)&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Note2 Regression for Count Data</title>
      <link>/post/note2-regression-for-count-data/</link>
      <pubDate>Fri, 28 Feb 2020 23:09:15 -0600</pubDate>
      <guid>/post/note2-regression-for-count-data/</guid>
      <description>


&lt;div id=&#34;possion-regression&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Possion Regression&lt;/h1&gt;
&lt;div id=&#34;model-objective&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Model Objective&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;Possion regression is the most common technique applied to model count data.&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;Possion Distribution&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Poisson distribution describes the number of events that occur in a given time period where its mean &lt;span class=&#34;math inline&#34;&gt;\(\lambda\)&lt;/span&gt; is the average number of events per period.&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y=y) = (\frac{e^{-\lambda}\lambda^y}{y!})\)&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;E(y) = Var(y) = &lt;span class=&#34;math inline&#34;&gt;\(\lambda\)&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;model-structure&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Model Structure&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(ln(E(Y)) = ln(\lambda) = X\beta = \beta_0 + \beta_1x_1 + \beta_2x_2 + \beta_3x_3 + ...\)&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;link function: log&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;model-assumption&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Model Assumption&lt;/span&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(y_i\)&lt;/span&gt; are independent of one another, and each &lt;span class=&#34;math inline&#34;&gt;\(y_i\)&lt;/span&gt; is a non-negative integer.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Each &lt;span class=&#34;math inline&#34;&gt;\(y_i\)&lt;/span&gt; follows the Poisson distribution with mean &lt;span class=&#34;math inline&#34;&gt;\(\lambda_i\)&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The ln(E(Y)) is a linear function of x.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The dependent variable is not over-dispersed and does not have an excessive number of zeros.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;parameter-estimates-and-interpretation&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Parameter estimates and interpretation&lt;/span&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;div id=&#34;model-fit&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Model Fit&lt;/span&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;negative-binomial-regression&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Negative Binomial Regression&lt;/h1&gt;
&lt;div id=&#34;model-objective-1&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Model Objective&lt;/span&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Negative Binomial Regression can be used to model count data with over-dispersion.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Over-dispersion means that there is more variation in the response than the model expected.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;model-structure-1&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Model Structure&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(ln(E(Y)) = ln(\lambda) = X\beta = \beta_0 + \beta_1x_1 + \beta_2x_2 + \beta_3x_3 + ...\)&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;link function: log&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;Possion Distribution&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y=y | \lambda, \alpha) = \frac{\Gamma(y+\alpha^{-1})}{y!\Gamma(\alpha^{-1})}(\frac{\alpha^{-1}}{\alpha^{-1}+\lambda})^{\alpha-1}(\frac{\lambda}{\alpha^{-1}+\lambda})\)&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;The negative binomial distribution has two parameters: λ and α&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;λ is the mean or expected value of the distribution&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;α is the over dispersion parameter&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;When α = 0 the negative binomial distribution is the same as a Poisson distributio&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;model-assumption-1&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Model Assumption&lt;/span&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;The response variable is a count variable and each subject has the same length of observation time.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The dependent variable is over-dispersed and does not have an excessive number of zeros.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Homework 6</title>
      <link>/post/bds751hw6/</link>
      <pubDate>Thu, 27 Feb 2020 21:59:31 -0600</pubDate>
      <guid>/post/bds751hw6/</guid>
      <description>


&lt;div id=&#34;question-1&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 1&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;Following is a sample of 1,000 gametes produced by a trihybrid individual. Please answer the following questions. Label each gamete (or haplotype) as non-recombinant, single recombinant or double recombinant. (Score 15)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;hw6q1.PNG&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Recombinant probability &lt;span class=&#34;math inline&#34;&gt;\(\theta\)&lt;/span&gt; has to be &lt;span class=&#34;math inline&#34;&gt;\(\leq 0.5\)&lt;/span&gt; and non-recombinat probability has to be &lt;span class=&#34;math inline&#34;&gt;\(\geq 0.5\)&lt;/span&gt;. There are 1000 gametes and the total number of the two non-recombinant haplotypes shoule be greater or equal than 500, hence Btr|bTR should be the individual’s diplotype. Below is my infer,&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th&gt;Haplotype&lt;/th&gt;
&lt;th&gt;Label&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;BTR&lt;/td&gt;
&lt;td&gt;single recombinant&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;btr&lt;/td&gt;
&lt;td&gt;single recombinant&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;Btr&lt;/td&gt;
&lt;td&gt;non-recombinant&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;bTR&lt;/td&gt;
&lt;td&gt;non-recombinant&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;BtR&lt;/td&gt;
&lt;td&gt;single recombinant&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;bTr&lt;/td&gt;
&lt;td&gt;single recombinant&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;BTr&lt;/td&gt;
&lt;td&gt;double recombinant&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;btR&lt;/td&gt;
&lt;td&gt;double recombinant&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div id=&#34;question-2&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 2&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;What is the probability of following pedigree genotype? If f(D)=0.1 and genotypes for subject 1, 2, 3, 4, and 5 are G1 = DD, G2 = DD, G3 = G4 = G5 = Dd? (Score 15)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;hw6q2.PNG&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(D) = 0.1 =&amp;gt; Pr(d) = 0.9\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(DD) = 0.01, Pr(Dd) = 0.18, Pr(dd) = 0.81\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(G1, G2, G3, G4, G5)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(G1)Pr(G2)Pr(G3 | G1, G2)Pr(G4)Pr(G5|G3, G4)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Because there is no way &lt;span class=&#34;math inline&#34;&gt;\(G3\)&lt;/span&gt; can be Dd given her parents don’t contain d in there genotype, &lt;span class=&#34;math inline&#34;&gt;\(Pr(G3 | G1, G2) = 0\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Hence,&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(G1, G2, G3, G4, G5) = 0\)&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-3&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 3&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;Suppose an autosome locus has alleles of D and d with f(D)=0.1 and penetrance, Pr(Y = 1|G1 = DD) = 0.8, Pr(Y = 1|G1 = Dd) = 0.4, and Pr(Y = 1|G1 = dd) = 0.2. We collected a sample as following and all individuals have genotypes of Dd. What is the sample’s joint probability Pr(Y1, Y2, Y3, Y4, Y5, G1, G2, G3, G4, G5)? (Score 15)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;hw6q3.PNG&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(D) = 0.1 =&amp;gt; Pr(d) = 0.9\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(DD) = 0.01, Pr(Dd) = 0.18, Pr(dd) = 0.81\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y=1 | G1 = DD = 0.8) =&amp;gt; Pr(Y=0 | G1 = DD = 0.2)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y=1 | G1 = Dd = 0.4) =&amp;gt; Pr(Y=0 | G1 = Dd = 0.6)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y=1 | G1 = dd = 0.2) =&amp;gt; Pr(Y=0 | G1 = DD = 0.8)\)&lt;/span&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y1, Y2, Y3, Y4, Y5, G1, G2, G3, G4, G5)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(Y1|G1)*Pr(Y2|G2)*Pr(Y3|G3)*Pr(Y4|G4)*Pr(Y5|G5)*Pr(G1,G2,G3,G4,G5)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;all individuals are independent&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(Y1|G1)*Pr(Y2|G2)*Pr(Y3|G3)*Pr(Y4|G4)*Pr(Y5|G5)*Pr(G1)*Pr(G2)*Pr(G3)*Pr(G4)*Pr(G5)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(Y=0|G1=Dd)^2 * Pr(Y=1|G1 = Dd)^3 * Pr(Dd)^5\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= 0.6^2 * 0.4^2 * 0.18^5 = 0.00001088391\)&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-4&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 4&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;Suppose an autosome locus has alleles of D and d with f(D)=0.1 and penetrance, Pr(Y = 1|G1 = DD) = 0.8, Pr(Y = 1|G1 = Dd) = 0.4, and Pr(Y = 1|G1 = dd) = 0.2. We collected a sample as following and we do not have their genotypes. What is the sample’s joint probability Pr(Y1, Y2, Y3, Y4, Y5, G1, G2, G3, G4, G5)? (Score 15)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;hw6q4.PNG&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(D) = 0.1 =&amp;gt; Pr(d) = 0.9\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(DD) = 0.01, Pr(Dd) = 0.18, Pr(dd) = 0.81\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y=1 | G1 = DD = 0.8) =&amp;gt; Pr(Y=0 | G1 = DD = 0.2)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y=1 | G1 = Dd = 0.4) =&amp;gt; Pr(Y=0 | G1 = Dd = 0.6)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y=1 | G1 = dd = 0.2) =&amp;gt; Pr(Y=0 | G1 = DD = 0.8)\)&lt;/span&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y=0)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(Y=0, DD) + Pr(Y=0, Dd) + Pr(Y=0, dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(Y=0|DD)Pr(DD) + Pr(Y=0|Dd)Pr(Dd) + Pr(Y=0|dd)Pr(dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= 0.2*0.01 + 0.6*0.18 + 0.8*0.81 = 0.758\)&lt;/span&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y=1)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(Y=1, DD) + Pr(Y=1, Dd) + Pr(Y=1, dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(Y=1|DD)Pr(DD) + Pr(Y=1|Dd)Pr(Dd) + Pr(Y=1|dd)Pr(dd)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= 0.8*0.01 + 0.4*0.18 + 0.2*0.81 = 0.242\)&lt;/span&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;We don’t know the sample’s genotypes and all of them are independent, so, when calculating the joint probability we can just ignore their genotypes.&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y1, Y2, Y3, Y4, Y5, G1, G2, G3, G4, G5)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(Y1)*Pr(Y2)*Pr(Y3)*Pr(Y4)*Pr(Y5)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(Y=0)^2*Pr(Y=1)^3\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= 0.758^2 * 0.242^3 = 0.00814300139\)&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-5&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 5&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;Suppose an autosome locus has alleles of D and d with f(D)=0.1 and penetrance, Pr(Y = 1|G1 = DD) = 0.8, Pr(Y = 1|G1 = Dd) = 0.4, and Pr(Y = 1|G1 = dd) = 0.2. We collected a sample as following and all individuals have genotypes of Dd. What is the sample’s joint probability Pr(Y1, Y2, Y3, Y4, Y5, G1, G2, G3, G4, G5)? (Score 20)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;hw6q5.PNG&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(D) = 0.1 =&amp;gt; Pr(d) = 0.9\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(DD) = 0.01, Pr(Dd) = 0.18, Pr(dd) = 0.81\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y=1 | G1 = DD = 0.8) =&amp;gt; Pr(Y=0 | G1 = DD = 0.2)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y=1 | G1 = Dd = 0.4) =&amp;gt; Pr(Y=0 | G1 = Dd = 0.6)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y=1 | G1 = dd = 0.2) =&amp;gt;Pr(Y=0 | G1 = DD = 0.8)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y1, Y2, Y3, Y4, Y5, G1, G2, G3, G4, G5)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(Y1|G1)*Pr(Y2|G2)*Pr(Y3|G3)*Pr(Y4|G4)*Pr(Y5|G5)*Pr(G1,G2,G3,G4,G5)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(Y1|G1)*Pr(Y2|G2)*Pr(Y3|G3)*Pr(Y4|G4)*Pr(Y5|G5)*Pr(G1)*Pr(G2)*Pr(G3|G1,G2)*Pr(G4)*Pr(G5)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(Y=0|G1=Dd)^2*Pr(Y=1|G1=Dd)^3*Pr(Dd)^4*0.5\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= 0.6^2 * 0.4^3 * 0.18^4 * 0.5 = 0.00001209323\)&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-6&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 6&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;Suppose an autosome locus has alleles of D and d with f(D)=0.1 and penetrances, Pr(Y = 1|G1 = DD) = 0, Pr(Y = 1|G1 = Dd) = 0, and Pr(Y = 1|G1 = dd) = 1. We collected a sample as following and we do not have their genotypes. What is the sample’s joint probability Pr(Y1, Y2, Y3, Y4, Y5, G1, G2, G3, G4, G5)? (score 20)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;hw6q6.PNG&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(D) = 0.1 =&amp;gt; Pr(d) = 0.9\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(DD) = 0.01, Pr(Dd) = 0.18, Pr(dd) = 0.81\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y=1 | G1 = DD = 0) =&amp;gt; Pr(Y=0 | G1 = DD = 1)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y=1 | G1 = Dd = 0) =&amp;gt; Pr(Y=0 | G1 = Dd = 1)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y=1 | G1 = dd = 1) =&amp;gt;Pr(Y=0 | G1 = DD = 0)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Based on the penetrances, we can conclude that people who has been affected have only one possiable genotype: dd. So, individual 2, individual 3 and individual 5 have genotype dd.&lt;/p&gt;
&lt;p&gt;Because invidual 3’s genotype(dd) is inherited from individual 2(dd) and individual 1(?). And for people who are not affected there are two possiable genotypes: DD and Dd, and individual 1’s genotype can only be Dd.&lt;/p&gt;
&lt;p&gt;So till now, there is only one individual’s genotype is unknown - individual 4. Due to 4 has not been affected, we will consider two genotypes for him(DD and Dd) when calculating the joint probability.&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y1, Y2, Y3, Y4, Y5, G1, G2, G3, G4, G5)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(Y1|G1)*Pr(Y2|G2)*Pr(Y3|G3)*Pr(Y4|G4)*Pr(Y5|G5)*Pr(G1,G2,G3,G4,G5)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= Pr(Y1|G1)*Pr(Y2|G2)*Pr(Y3|G3)*Pr(Y4|G4)*Pr(Y5|G5)*Pr(G1)*Pr(G2)*Pr(G3|G1,G2)*Pr(G4)*Pr(G5)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y1|G1) = Pr(Y=0|Dd) = 1\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y2|G2) = Pr(Y=1|dd) = 1\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y3|G3) = Pr(Y=1|dd) = 1\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y4|G4) = Pr(Y=0|DDorDd) = 1\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(Y5|G5) = Pr(Y=1|dd) = 1\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(G1) = Pr(Dd) = 0.18\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(G2) = Pr(G3) = Pr(G5) = Pr(dd) = 0.81\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(G3|G1,G2) = Pr(dd|Dd,dd) = 0.5\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Ans = &lt;span class=&#34;math inline&#34;&gt;\(1*1*1*1*1*0.18*0.81^3*0.5 = 0.04782969\)&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Note8 Glm Diagnostics</title>
      <link>/post/note8-glm-diagnostics/</link>
      <pubDate>Thu, 27 Feb 2020 15:56:36 -0600</pubDate>
      <guid>/post/note8-glm-diagnostics/</guid>
      <description>


&lt;div id=&#34;assessing-the-link-function&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Assessing the Link Function&lt;/span&gt;&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Pregibon link test&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Run GLM.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Obtain fitted values for linear predictor.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Create new variables &lt;span class=&#34;math inline&#34;&gt;\((X\hat{\beta})^2\)&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Run model with &lt;span class=&#34;math inline&#34;&gt;\(X\hat{\beta} + (X\hat{\beta})^2\)&lt;/span&gt; as predictors.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;evaluate: if p-value is not significant for &lt;span class=&#34;math inline&#34;&gt;\((X\hat{\beta})^2\)&lt;/span&gt; term, link function is correctly specified.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;a3p2c1.PNG&#34; /&gt;&lt;/p&gt;
&lt;p&gt;The p-value for _hatsq is greater 0.05 which is not statistically significant indicatiing that the model seems to be well specified.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;outlier-detection&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Outlier Detection&lt;/span&gt;&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Cook’s distance measures the aggregate change in the estimated coefficients when each observation is left out of the estimation.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div id=&#34;rules-of-thumb&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Rules of thumb:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(C_i &amp;gt; \frac{4}{n-p-1}\)&lt;/span&gt; n = number of total observations. p = number of coefficients&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(C_i &amp;gt; \frac{3\sum{C_i}}{n}\)&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(C_i &amp;gt; 1\)&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;r-square&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;R-square&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;In ordinary least squares(OLS) regression, &lt;span class=&#34;math inline&#34;&gt;\(R^2 = 1 - \frac{\sum_{i=1}^N(y_i - \hat{y_i})^2}{\sum_{i=1}^N(y_i - \bar{y})^2}\)&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;N is the number of pbservations in the model.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;y is the dependent variable.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;y-hat is the value predicted by the model.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(R^2\)&lt;/span&gt; is typically interpreted as % variance explained, but &lt;span class=&#34;math inline&#34;&gt;\(Pseudo-R^2 = (correlation(y,\hat{y}))^2\)&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;information-criteria&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Information Criteria&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;The AIC and BIC are two popular measures for comparing maximum likelihood models.&lt;a href=&#34;#fn1&#34; class=&#34;footnote-ref&#34; id=&#34;fnref1&#34;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;AIC = Akaike Information Criterion&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(AIC = -2*ln(likelihood) + 2*k\)&lt;/span&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;BIC = Bayesian Information Criterion&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(BIC = -2*ln(likelihood) + ln(N)*k\)&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;k = number of parameters estimated&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;N = number of observations&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;AIC and BIC can be viewed as measures that combine fit and complexity.&lt;/p&gt;
&lt;p&gt;Fit is measured negatively by −2 × ln(likelihood); the larger the value, the worse the fit.&lt;/p&gt;
&lt;p&gt;Complexity is measured positively, either by 2 × k (AIC) or ln(N) × k (BIC).&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:pink&#34;&gt;Given two models fit on the same data, the model with the smaller value of the information criterion is considered to be better.&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;residuals&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Residuals&lt;/span&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;div class=&#34;footnotes&#34;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&#34;fn1&#34;&gt;&lt;p&gt;&lt;a href=&#34;https://www.stata.com/manuals/rbicnote.pdf&#34; class=&#34;uri&#34;&gt;https://www.stata.com/manuals/rbicnote.pdf&lt;/a&gt;&lt;a href=&#34;#fnref1&#34; class=&#34;footnote-back&#34;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Homework 5</title>
      <link>/post/bds751hw5/</link>
      <pubDate>Sun, 23 Feb 2020 11:55:44 -0600</pubDate>
      <guid>/post/bds751hw5/</guid>
      <description>


&lt;div id=&#34;question-1&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 1&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;Suppose the genetic distance is d Morgan between two loci (i.e. average d crossovers will occur per meiosis). Infer recombination probability θ between the two loci per meiosis (i.e. the map function, θ(d)) (Score 20)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;x: number of observed crossovers&lt;br /&gt;
d: genetic distance between two loci
θ(d): prob of recombination between two loci per meiosis&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(f(X = x) = \frac{e^{-d}d^x}{x!},x = 0,1,2,..\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(\theta(d) = \sum_{odd x}f(X=x)\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= \sum_{oddx}\frac{e^{-d}d^x}{x!}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= \frac{1}{2}(\sum_{oddx}\frac{e^{-d}d^x}{x!} + \sum_{oddx}\frac{e^{-d}d^x}{x!} + \sum_{evenx}\frac{e^{-d}d^x}{x!} - \sum_{evenx}\frac{e^{-d}d^x}{x!})\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= \frac{e^{-d}}{2}(\sum_{oddx}\frac{d^x}{x!}+(\sum_{oddx}\frac{d^x}{x!}+\sum_{evenx}\frac{d^x}{x!})-\sum_{evenx}\frac{d^x}{x!})\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= \frac{e^{-d}}{2}(-\sum_{oddx}\frac{(-d)^x}{x!} + \sum_{x=0}^\infty\frac{d^x}{x!} - \sum_{evenx}\frac{(-d)^x}{x!})\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= \frac{e^{-d}}{2}(\sum_{x=0}^\infty\frac{d^x}{x!}-(\sum_{oddx}\frac{(-d)^x}{x!} + \sum_{evenx}\frac{(-d)^x}{x!}))\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(= \frac{e^{-d}}{2}(\sum_{x=0}^\infty\frac{d^x}{x!} - \sum_{x=0}^\infty\frac{(-d)^x}{x!})\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Based on Taylor Series&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(e^d = \sum_{x=0}^\infty\frac{d^x}{x!}, x = 0,1,2,...\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(e^{-d} = \sum_{x=0}^\infty\frac{(-d)^x}{x!}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Hence,&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(\theta(d) = \frac{e^{-d}}{2}(e^d - e^{-d}) = \frac{1-e^{-2d}}{2}\)&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-2&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 2&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;Suppose the recombinatin probability between two loci is θ. (Score 20)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;a. If parent genotype for the two loci is dm|Dm, what are transmitted haplotypes and their probabilities?&lt;/span&gt;&lt;br /&gt;
transmitted haplotypes: dm, Dm&lt;br /&gt;
Pr(dm) = Pr(Dm) = 0.5&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;b. If parent genotype for the two loci is Dm|DM, what are transmitted haplotypes and their probabilities?&lt;/span&gt;&lt;br /&gt;
transmitted haplotypes: Dm, DM&lt;br /&gt;
Pr(Dm) = Pr(DM) = 0.5&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;c. If parent genotype for the two loci is dm|DM, what are transmitted haplotypes and their probabilities?&lt;/span&gt;&lt;br /&gt;
transmitted haplotypes: dm, DM, dM, Dm&lt;br /&gt;
Pr(dm) = Pr(DM) = &lt;span class=&#34;math inline&#34;&gt;\(\frac{1-\theta}{2}\)&lt;/span&gt;&lt;br /&gt;
Pr(dM) = Pr(Dm) = &lt;span class=&#34;math inline&#34;&gt;\(\frac{\theta}{2}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;d. If parent genotype for the two loci is dM|Dm, what are transmitted haplotypes and their probabilities?&lt;/span&gt;&lt;br /&gt;
transmitted haplotypes: dM, Dm, dm, DM&lt;br /&gt;
Pr(dM) = Pr(Dm) = &lt;span class=&#34;math inline&#34;&gt;\(\frac{1-\theta}{2}\)&lt;/span&gt;&lt;br /&gt;
Pr(dm) = Pr(DM) = &lt;span class=&#34;math inline&#34;&gt;\(\frac{\theta}{2}\)&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-3&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 3&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;Suppose a family pedigree is as follows. (Score 35)&lt;/span&gt;&lt;br /&gt;
&lt;img src=&#34;q3.PNG&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;a. What are recombinant haplotypes?&lt;/span&gt;&lt;br /&gt;
Dm and dM&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;b. What are non-recombinant haplotypes?&lt;/span&gt;&lt;br /&gt;
DM, dm&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;c. Estimate recombination probability θ and what is the standard error?&lt;/span&gt;&lt;br /&gt;
&lt;span class=&#34;math inline&#34;&gt;\(n = 5, r = 1, s = 4\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(\theta = \frac{1}{5} = 0.2\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(se = \sqrt{\frac{rs}{n^3}} = \sqrt{\frac{4}{125}}=0.179\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;d. We want to test if there is independent assortment between the two loci. What is the &lt;span class=&#34;math inline&#34;&gt;\(H_0\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(H_1\)&lt;/span&gt;?&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(H_0\)&lt;/span&gt; : &lt;span class=&#34;math inline&#34;&gt;\(\theta = 0.5\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(H_1\)&lt;/span&gt; : &lt;span class=&#34;math inline&#34;&gt;\(\theta \leq 0.5\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;e. Conduct a statistical test of question d, and show your conclusion. (Hint: binomial test)&lt;/span&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;binom.test(x=1,n=5,p=0.5,alternative=c(&amp;quot;less&amp;quot;),conf.level=0.95)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 
##  Exact binomial test
## 
## data:  1 and 5
## number of successes = 1, number of trials = 5, p-value = 0.1875
## alternative hypothesis: true probability of success is less than 0.5
## 95 percent confidence interval:
##  0.0000000 0.6574083
## sample estimates:
## probability of success 
##                    0.2&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The p-value for our test is 0.1875 which is greater than 0.05, so we failed to reject the null hypotheis and conclude that &lt;span class=&#34;math inline&#34;&gt;\(\theta = 0.5\)&lt;/span&gt; whcih means there is independent assortment between the two loci.&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;f. Extra Credit (Score 5): Suppose we do not know father’s genotype in the pedigree. Can we infer the father’s genotype with haplotype information and what are they?&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Yes, we can. Offspring’s genotypes contain allele D/d and allele M/m, so, father’s genotype must contain D,d,M,m.&lt;br /&gt;
And among offspring, there are three types of haplotypes came from father, they are DM, dm and Dm.&lt;br /&gt;
Hence, father’s genotype should be informative, and there are two possiable genotypes for father.&lt;br /&gt;
1. DM|dm 2. Dm|dM&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-4&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 4&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;Weather report shows that snowing probability on Friday is 60%. Big data analysis indicates that the probability of UMMC cancelling class is 70% if there is snow, and the probability is 5% if there is no snow. (Score: 15)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;a. Construct the contingency table of probability (Score: 5)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(snow) = 0.6\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(no-snow) = 0.4\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(cancel | snow) = 0.7\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(cancel | no-snow) = 0.05\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(snow, cancel) = Pr(cancel | snow)Pr(snow) = 0.7*0.6 = 0.42\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(snow, no-cancel) = Pr(snow) - Pr(snow, cancel) = 0.6 - 0.42 = 0.18\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(no-snow, cancel) = Pr(cancel | no-snow)Pr(no-snow) = 0.05*0.4 = 0.02\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(no-snow, no-cancel) = Pr(no-snow) - Pr(no-snow, cancel) = 0.4 - 0.02 = 0.38\)&lt;/span&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th&gt;~~~~~&lt;/th&gt;
&lt;th&gt;cancel&lt;/th&gt;
&lt;th&gt;no-cancel&lt;/th&gt;
&lt;th&gt;~~~~~&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;snow&lt;/td&gt;
&lt;td&gt;0.42&lt;/td&gt;
&lt;td&gt;0.18&lt;/td&gt;
&lt;td&gt;0.6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;no-snow&lt;/td&gt;
&lt;td&gt;0.02&lt;/td&gt;
&lt;td&gt;0.38&lt;/td&gt;
&lt;td&gt;0.4&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;~~~~~&lt;/td&gt;
&lt;td&gt;0.44&lt;/td&gt;
&lt;td&gt;0.56&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;b. What is the probability that class will be cancelled on Friday? (Score: 5)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Pr(cancel) = Pr(cancel, snow) + Pr(cancel, no-snow) = 0.42 + 0.02 = 0.44&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;c. What is the probability that there is snow on Friday if class is canceled? (Score: 5)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(snow | cancel) = \frac{Pr(snow,cancel)}{Pr(cancel)} = \frac{0.42}{0.44} = 0.955\)&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;question-5&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Question 5&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;A prospective study collected 100 smokers and 100 non-smokers. After 10 years, the study observed 30 smokers and 10 non-smokers got lung cancer. If our objective is that smoking is associated with cancer risk, then&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;a. Write down the hypothesis and estimate the parameters for hypothesis test (Score: 10) &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(H_0\)&lt;/span&gt; : Pr(cancer, smoker) = Pr(cancer, non-smoker)&lt;br /&gt;
&lt;span class=&#34;math inline&#34;&gt;\(H_a\)&lt;/span&gt; : Pr(cancer, smoker) &lt;span class=&#34;math inline&#34;&gt;\(\neq\)&lt;/span&gt; Pr(cancer, non-smoker)&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(cancer,smoker) = \frac{30}{100} = 0.3\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(Pr(cancer,non-smoker) = \frac{10}{100} = 0.1\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;b. perform a statistical test, get the statistic with p-value and show your conclusion (Score: 10) &lt;/span&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th&gt;~~~~~&lt;/th&gt;
&lt;th&gt;cancer&lt;/th&gt;
&lt;th&gt;no-cancer&lt;/th&gt;
&lt;th&gt;~~~~~&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;smoker&lt;/td&gt;
&lt;td&gt;30&lt;/td&gt;
&lt;td&gt;70&lt;/td&gt;
&lt;td&gt;100&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;non-smoker&lt;/td&gt;
&lt;td&gt;10&lt;/td&gt;
&lt;td&gt;90&lt;/td&gt;
&lt;td&gt;100&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;~~~~~&lt;/td&gt;
&lt;td&gt;40&lt;/td&gt;
&lt;td&gt;160&lt;/td&gt;
&lt;td&gt;200&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(\hat{p_1} = 0.3, x_1 = 30, n_1 = 100\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(\hat{p_2} = 0.1, x_2 = 10, n_2 = 100\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(\bar{p} = \frac{x_1 + x_2}{n_1 + n_2} = \frac{40}{200} = 0.2\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(\hat{\sigma}_{\hat{p_1} - \hat{p_2}} = \sqrt{\frac{\bar{p}(1-\bar{p})}{n_1} + \frac{\bar{p}(1-\bar{p})}{n_2}}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;$ = = 0.0566$&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(z = \frac{\hat{p_1} - \hat{p_2}}{\hat{\sigma}_{\hat{p_1} - \hat{p_2}}} = \frac{0.3-0.1}{0.0566} = 3.54\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The P-Value is .0004.&lt;/p&gt;
&lt;p&gt;Because our p-value is 0.0004 which is less than 0 at 0.05 alpha level, we reject the null hypothesis and conclude that smoking is associated with cancer risk.&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Note12 Cox Model Diagnostics</title>
      <link>/post/note12-cox-model-diagnostics/</link>
      <pubDate>Thu, 20 Feb 2020 16:32:49 -0600</pubDate>
      <guid>/post/note12-cox-model-diagnostics/</guid>
      <description>


&lt;div id=&#34;testing-the-proportional-hazard-assumptions&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Testing the Proportional Hazard Assumptions&lt;/span&gt;&lt;/h2&gt;
&lt;div id=&#34;schoenfeld-residuals1&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;&lt;span style=&#34;color:green&#34;&gt;Schoenfeld Residuals&lt;a href=&#34;#fn1&#34; class=&#34;footnote-ref&#34; id=&#34;fnref1&#34;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Instead of a single residual for each individual, there is a separate residual for each individual for each covariate.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Schonefeld residuals are not defined for censored individuals.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;&lt;span class=&#34;math inline&#34;&gt;\(Schonefeld residual = x_{ik} - \sum_{i=1}^{j\in R(t_i)} x_{kj}P_j\)&lt;/span&gt;&lt;/span&gt;
- The Schoenfeld residual is the covariate-value, &lt;span class=&#34;math inline&#34;&gt;\(x_{ik}\)&lt;/span&gt;, for the person i who actually died at time &lt;span class=&#34;math inline&#34;&gt;\(t_i\)&lt;/span&gt; minus the expected value of the covariate for the risk set at &lt;span class=&#34;math inline&#34;&gt;\(t_i\)&lt;/span&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Plot Schoenfeld residuals against time to evaluate PH assumption.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;If the slope is not zero then the proportional hazard assumption has been violated.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;kaplan-meier-curves2&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;&lt;span style=&#34;color:green&#34;&gt;Kaplan-Meier Curves&lt;a href=&#34;#fn2&#34; class=&#34;footnote-ref&#34; id=&#34;fnref2&#34;&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;If the predictor satisfy the proportional hazard assumption then the graph of the survival function versus the survival time should results in a graph with parallel curves.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;This method does not work well for continuous predictor or categorical predictors that have many levels because the graph becomes to “cluttered”.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;log-log-plot2&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;&lt;span style=&#34;color:green&#34;&gt;Log-log Plot&lt;a href=&#34;#fn3&#34; class=&#34;footnote-ref&#34; id=&#34;fnref3&#34;&gt;&lt;sup&gt;3&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;The log(-log(survival)) versus log of survival time graph should result in parallel lines if the predictor is proportional.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;general-model-fit&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;General Model Fit&lt;/span&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;Theorem:&lt;/span&gt; Suppose T is a continuous nonnegative random variable with cumulative hazard function &lt;span class=&#34;math inline&#34;&gt;\(\Lambda\)&lt;/span&gt;. Then the random variaable $ Y = (T)$ follows an exponential distribution with rate&lt;span class=&#34;math inline&#34;&gt;\(\lambda = 1\)&lt;/span&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;One way of checking the validty of a model is by comparing the model’s estimates {&lt;span class=&#34;math inline&#34;&gt;\(\hat{\Lambda}(t_i)\)&lt;/span&gt;} against the standard exponential distribution.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div id=&#34;cox-snell-residuals&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;&lt;span style=&#34;color:green&#34;&gt;Cox-Snell Residuals&lt;/span&gt;&lt;/h3&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;&lt;span class=&#34;math inline&#34;&gt;\(\hat{e}_i = \hat{\Lambda_0}(t_i) exp(x_i^T \hat{\beta})\)&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Application: to examine the overall fit of a Cox model: by plotting the Cox-Snell residual against the cumulative hazard function.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;A well fitting model will exhibit a linear line through the origin with a unit gradien.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;These residuals should behave like a sample from an exponential distribution with a mean equal to 1.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Cox-Snell residuals do not account for censored observations.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;One drawback to the Cox-Snell residuals is that they don’t
provide much insight into why the model’s assumptions are
violated。&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;martingale-residuals3&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;&lt;span style=&#34;color:green&#34;&gt;Martingale Residuals&lt;a href=&#34;#fn4&#34; class=&#34;footnote-ref&#34; id=&#34;fnref4&#34;&gt;&lt;sup&gt;4&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/h3&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(\hat{m}_{i} = d_i - \hat{\Lambda}_i(t_i)\)&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Martingale residuals can be used to assess the true functional form of a particular covariate (Thernau et al. (1990)).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Positive values mean that the patient died sooner than expected (according to the model); negative values mean that the patient lived longer than expected (or were censored).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Martingale residuals are very useful and can be used for many of the usual purposes that we use residuals for in other models (identifying outliers, choosing a functional form for the covariate, etc.)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;However, the primary drawback to the martingale residual is its clear asymmetry (its upper bound is 1, but it has no lowerbound)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;outliers-identification&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;&lt;span style=&#34;color:green&#34;&gt;Outliers Identification&lt;/span&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;Overall:&lt;/span&gt; plot deviance residual vs time.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;Variable Specific:&lt;/span&gt;plot dfBetas vs time.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;DFBetas&lt;/span&gt; Measure of how much an observation has effected the estimate of a regression coefficient (there is one DFBETA for each regression coefficient, including the intercept). Values larger than 2/sqrt(n) in absolute value are considered highly influential.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;linearity-visual&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;&lt;span style=&#34;color:green&#34;&gt;Linearity Visual&lt;/span&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;plot deviance residual vs continuous variable&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;predictive-power&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;&lt;span style=&#34;color:green&#34;&gt;Predictive Power&lt;/span&gt;&lt;/h3&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;Harrell’s C-index (concordance index)&lt;a href=&#34;#fn5&#34; class=&#34;footnote-ref&#34; id=&#34;fnref5&#34;&gt;&lt;sup&gt;5&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;:&lt;/p&gt;
&lt;p&gt;The intuition behind Harrell’s C-index is as follows. For patient i, our risk model assigns a risk score &lt;span class=&#34;math inline&#34;&gt;\(\eta_i\)&lt;/span&gt; . If our risk model is any good, patients who had shorter times-to-disease should have higher risk scores. Boiling this intuition down to two patients: the patient with the higher risk score should have a shorter time-to-disease.&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;We can compute the C-index in the following way: For every pair of patients i and j (with i &lt;span class=&#34;math inline&#34;&gt;\(\neq\)&lt;/span&gt; j), look at their risk scores and times-to-event.&lt;/p&gt;
&lt;div id=&#34;both-i-and-j-are-not-censored&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;&lt;span style=&#34;color:pink&#34;&gt;Both i and j are not censored&lt;/span&gt;&lt;/h4&gt;
&lt;p&gt;If &lt;span class=&#34;math inline&#34;&gt;\(T_j\)&lt;/span&gt; &amp;lt; &lt;span class=&#34;math inline&#34;&gt;\(T_i\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(\eta_j &amp;lt; \eta_i\)&lt;/span&gt; =&amp;gt; &lt;span style=&#34;color:orange&#34;&gt;discordant pair&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;If &lt;span class=&#34;math inline&#34;&gt;\(T_j\)&lt;/span&gt; &amp;lt; &lt;span class=&#34;math inline&#34;&gt;\(T_i\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(\eta_j &amp;gt; \eta_i\)&lt;/span&gt; =&amp;gt; &lt;span style=&#34;color:orange&#34;&gt;concordant pair&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;discordant pair:&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;both-i-and-j-are-censored&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;&lt;span style=&#34;color:pink&#34;&gt;Both i and j are censored&lt;/span&gt;&lt;/h4&gt;
&lt;p&gt;We don’t consider this pair in this situation.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;i-is-censored-and-j-is-not-censored&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;&lt;span style=&#34;color:pink&#34;&gt;i is censored and j is not censored&lt;/span&gt;&lt;/h4&gt;
&lt;p&gt;If &lt;span class=&#34;math inline&#34;&gt;\(T_j\)&lt;/span&gt; &amp;lt; &lt;span class=&#34;math inline&#34;&gt;\(T_i\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(\eta_i &amp;gt; \eta_j\)&lt;/span&gt; =&amp;gt; &lt;span style=&#34;color:orange&#34;&gt;discordant pair&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;If &lt;span class=&#34;math inline&#34;&gt;\(T_j\)&lt;/span&gt; &amp;lt; &lt;span class=&#34;math inline&#34;&gt;\(T_i\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(\eta_i &amp;lt; \eta_j\)&lt;/span&gt; =&amp;gt; &lt;span style=&#34;color:orange&#34;&gt;concordant pair&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;If &lt;span class=&#34;math inline&#34;&gt;\(T_j\)&lt;/span&gt; &amp;gt; &lt;span class=&#34;math inline&#34;&gt;\(T_i\)&lt;/span&gt; then we don’t know who got disease first, we don’t consider this pair in this situation.&lt;/p&gt;
&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;c = #concordant_pairs / #concordant_pairs + #discordant_pairs&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Values of c near 0.5 indicate that the risk score predictions are no better than a coin flip in determining which patient will live longer.&lt;/p&gt;
&lt;p&gt;Values near 1 indicate that the risk scores are good at determining which of two patients will have the disease first.&lt;/p&gt;
&lt;p&gt;Values near 0 means that the risk scores are worse than a coin flip: you might be better off concluding the opposite of what the risk scores tell you.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#34;footnotes&#34;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&#34;fn1&#34;&gt;&lt;p&gt;&lt;a href=&#34;https://slideplayer.com/slide/14000214/&#34; class=&#34;uri&#34;&gt;https://slideplayer.com/slide/14000214/&lt;/a&gt;&lt;a href=&#34;#fnref1&#34; class=&#34;footnote-back&#34;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn2&#34;&gt;&lt;p&gt;&lt;a href=&#34;https://stats.idre.ucla.edu/other/examples/asa2/testing-the-proportional-hazard-assumption-in-cox-models/&#34; class=&#34;uri&#34;&gt;https://stats.idre.ucla.edu/other/examples/asa2/testing-the-proportional-hazard-assumption-in-cox-models/&lt;/a&gt;&lt;a href=&#34;#fnref2&#34; class=&#34;footnote-back&#34;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn3&#34;&gt;&lt;p&gt;&lt;a href=&#34;https://stats.idre.ucla.edu/other/examples/asa2/testing-the-proportional-hazard-assumption-in-cox-models/&#34; class=&#34;uri&#34;&gt;https://stats.idre.ucla.edu/other/examples/asa2/testing-the-proportional-hazard-assumption-in-cox-models/&lt;/a&gt;&lt;a href=&#34;#fnref3&#34; class=&#34;footnote-back&#34;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn4&#34;&gt;&lt;p&gt;&lt;a href=&#34;https://myweb.uiowa.edu/pbreheny/7210/f15/notes/11-10.pdf&#34; class=&#34;uri&#34;&gt;https://myweb.uiowa.edu/pbreheny/7210/f15/notes/11-10.pdf&lt;/a&gt;&lt;a href=&#34;#fnref4&#34; class=&#34;footnote-back&#34;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn5&#34;&gt;&lt;p&gt;&lt;a href=&#34;https://statisticaloddsandends.wordpress.com/2019/10/26/what-is-harrells-c-index/&#34; class=&#34;uri&#34;&gt;https://statisticaloddsandends.wordpress.com/2019/10/26/what-is-harrells-c-index/&lt;/a&gt;&lt;a href=&#34;#fnref5&#34; class=&#34;footnote-back&#34;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Note11 Cox Models</title>
      <link>/post/note11-cox-models/</link>
      <pubDate>Thu, 20 Feb 2020 13:21:32 -0600</pubDate>
      <guid>/post/note11-cox-models/</guid>
      <description>


&lt;p&gt;Cox Models = Propotional Hazards Models&lt;/p&gt;
&lt;div id=&#34;modeling-the-hazard-function1&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt;Modeling the Hazard Function&lt;a href=&#34;#fn1&#34; class=&#34;footnote-ref&#34; id=&#34;fnref1&#34;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Survival analysis methods, such as proportional hazards regression differ from logistic regression by assessing a rate instead of a proportion.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Proportional hazards regression, also called Cox regression, &lt;span style=&#34;color:orange&#34;&gt;models the incidence or hazard rate, the number of new cases of disease per population at-risk per unit time.&lt;/span&gt; If the outcome is death, this is the mortality rate.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The hazard function is the probability that if a person survives to t, they will experience the event in the next instant.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(\lambda (t|X_{1i}, X_{2i}, ..., X_{ki}) = \lambda _0 (t)exp(\beta_1X_{1i} + \beta_2X_{2i} + ... +\beta_kX_{ki})\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(log(\frac{\lambda (t|X_{1i}, X_{2i}, ..., X_{ki})}{\lambda _0 (t)}) = exp(\beta_1X_{1i} + \beta_2X_{2i} + ... +\beta_kX_{ki})\)&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;&lt;span class=&#34;math inline&#34;&gt;\(\lambda (t|X_{1i}, X_{2i}, ..., X_{ki}):\)&lt;/span&gt;&lt;/span&gt; this is the the hazard function for the ith person at time t,i=1,2,⋯,n.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;&lt;span class=&#34;math inline&#34;&gt;\(\lambda _0 (t):\)&lt;/span&gt;&lt;/span&gt; this is the baseline hazard function at time t, which is analogous to the intercept term in a multiple regression or logistic regression model. And it is unknown.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span style=&#34;color:orange&#34;&gt;&lt;span class=&#34;math inline&#34;&gt;\(log(\frac{\lambda (t|X_{1i}, X_{2i}, ..., X_{ki})}{\lambda _0 (t)}):\)&lt;/span&gt;&lt;/span&gt; this is the log of hazard ratio. The ratio of hazard functions can be considered a ratio of risk functions.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;There is no particular probability model selected to represent the survival times.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;But there is a big &lt;span style=&#34;color:orange&#34;&gt;assumption&lt;/span&gt;: the hazard for any individual is a fixed proportion of the hazard for any other individual. (i.e., proportional hazards). Notice if &lt;span class=&#34;math inline&#34;&gt;\(λ_0(t)\)&lt;/span&gt; is the hazard function for a subject with all the predictor values equal to zero and &lt;span class=&#34;math inline&#34;&gt;\(λ_1(t)\)&lt;/span&gt; is the hazard function for a subject with other values for the predictor variables, then the hazard ratio depends only on the predictor variables and not on time t. This assumption means if a covariate doubles the risk of the event on day one, it also doubles the risk of the event on any other day.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;output-interpretation&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style = &#34;color:red&#34;&gt;Output Interpretation&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;span style=&#34;color:green&#34;&gt;Hazard Ratio&lt;/span&gt;: similar with odds ratio.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span style=&#34;color:green&#34;&gt;Continuous&lt;/span&gt;: A unit increase in X is associated with a YY% increase/decrease in the hazard of (event) on average.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span style=&#34;color:green&#34;&gt;Binary&lt;/span&gt;: On average, A has YY% higher/lower hazard of (event) compared to B.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&#34;footnotes&#34;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&#34;fn1&#34;&gt;&lt;p&gt;&lt;a href=&#34;https://online.stat.psu.edu/stat507/node/81/&#34; class=&#34;uri&#34;&gt;https://online.stat.psu.edu/stat507/node/81/&lt;/a&gt;&lt;a href=&#34;#fnref1&#34; class=&#34;footnote-back&#34;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Note10 Kaplan Meier Estimation</title>
      <link>/post/note10-kaplan-meier-estimation/</link>
      <pubDate>Tue, 18 Feb 2020 21:53:55 -0600</pubDate>
      <guid>/post/note10-kaplan-meier-estimation/</guid>
      <description>


&lt;div id=&#34;understanding-k-m-curve&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt; Understanding K-M Curve &lt;/span&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;the K-M survival curve is defined as the probability of surviving in a given length of time while considering time in many small intervals.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;interval: the horizontal line in K-M graph.&lt;br /&gt;
serial time duration contains two types of duration:&lt;br /&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;known survival(event occured)&lt;br /&gt;
&lt;/li&gt;
&lt;li&gt;unknown survival(censored)&lt;br /&gt;
and only 1 are called interval in K-M graph, 2 are indicated on K-M curve as tick marks.&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;vertical distance between horizontals: illustrate the change in cumulative survival probablity as the curve advances.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;K-M curve are not smooth function, but rather step-wise estimates.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;In K-M curve, the Y axis stands for cumulative surviving probability.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;cumulative surviving prob = &lt;span class=&#34;math inline&#34;&gt;\(\Pi (interval survival rate)\)&lt;/span&gt;, each horizontal line as an interval survival rate,&lt;br /&gt;
interval survival rate = &lt;span class=&#34;math inline&#34;&gt;\(\frac{total-number-of-current-alive-people}{total-number-of-alive-people- in-previous-horizontal-line-excluding-censored-people}\)&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;censoring has an effect on the survival rate.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;censoring removes the subjects from the denominator.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;K-M Estimation is a non-parametric estimation of survival function.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;when no event times are censored, a non-parametric estimator of S(T) is &lt;span class=&#34;math inline&#34;&gt;\(1-F_{n}(t)\)&lt;/span&gt;, where &lt;span class=&#34;math inline&#34;&gt;\(F_{n}(t)\)&lt;/span&gt; is the empirical cumulative distribution function.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;when some observations are censored, we can estimate S(t) using KM estimation.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Let: &lt;span class=&#34;math inline&#34;&gt;\(n_i\)&lt;/span&gt; be number of objects at risk of dying at time &lt;span class=&#34;math inline&#34;&gt;\(t_i\)&lt;/span&gt;&lt;br /&gt;
&lt;span class=&#34;math inline&#34;&gt;\(d_i\)&lt;/span&gt; be number of events that occur at time &lt;span class=&#34;math inline&#34;&gt;\(t_i\)&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;km-estimator&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt; KM estimator &lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(\hat{S}(t) = \prod_{k=1}^i \frac{n_k - d_k}{n_k}\)&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;basic-tests-for-difference-in-survival-curves&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt; Basic tests for difference in survival curves&lt;/h2&gt;
&lt;p&gt;Want to test:&lt;br /&gt;
&lt;span class=&#34;math inline&#34;&gt;\(H_0: S_1(t) = S_2(t)\)&lt;/span&gt;&lt;br /&gt;
&lt;span class=&#34;math inline&#34;&gt;\(H_1: S_1(t) \neq S_2(t)\)&lt;/span&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;mydat &amp;lt;- matrix(c(&amp;#39;d1i&amp;#39;,&amp;#39;d2i&amp;#39;,&amp;#39;n1i-d1i&amp;#39;,&amp;#39;n2i-d2i&amp;#39;),ncol = 2, byrow = T)
colnames(mydat) &amp;lt;- c(&amp;#39;Group 1&amp;#39;, &amp;#39;Group 2&amp;#39;)
rownames(mydat) &amp;lt;- c(&amp;#39;Died&amp;#39;,&amp;#39;Survived&amp;#39;)
mydat&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##          Group 1   Group 2  
## Died     &amp;quot;d1i&amp;quot;     &amp;quot;d2i&amp;quot;    
## Survived &amp;quot;n1i-d1i&amp;quot; &amp;quot;n2i-d2i&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Test Statistic:&lt;br /&gt;
&lt;span class=&#34;math inline&#34;&gt;\(Q = \frac{(\sum w_i (d_{1i} - \hat{e}_{1i}))^2}{\sum w_i ^2 \hat{v}_{1i}}\)&lt;/span&gt;
where:&lt;br /&gt;
&lt;span class=&#34;math inline&#34;&gt;\(\hat{e}_{1i} = \frac{n_{1i}d_{1i}}{n_{i}}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(\hat{v}_{1i} = \frac{n_{1i}n_{2i}d_i (n_i - d_i)}{n_i ^2 (n_i - 1)}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(w_i =\)&lt;/span&gt; some weighting functing&lt;/p&gt;
&lt;p&gt;Tests:&lt;br /&gt;
Log-rank: &lt;span class=&#34;math inline&#34;&gt;\(w_i = 1\)&lt;/span&gt;&lt;br /&gt;
Wilcoxon: &lt;span class=&#34;math inline&#34;&gt;\(w_i = n_i\)&lt;/span&gt;&lt;br /&gt;
Tarone-ware: &lt;span class=&#34;math inline&#34;&gt;\(w_i = \sqrt{n_i}\)&lt;/span&gt;&lt;br /&gt;
Peto-Peto: &lt;span class=&#34;math inline&#34;&gt;\(w_i = \prod_{i=1}^T (\frac{1-\hat{e}_i}{n_i + 1})\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Reference:&lt;br /&gt;
Rich, J. T., Neely, J. G., Paniello, R. C., Voelker, C. C., Nussenbaum, B., &amp;amp; Wang, E. W. (2010). A practical guide to understanding Kaplan-Meier curves. Otolaryngology–head and neck surgery : official journal of American Academy of Otolaryngology-Head and Neck Surgery, 143(3), 331–336. &lt;a href=&#34;https://doi.org/10.1016/j.otohns.2010.05.007&#34; class=&#34;uri&#34;&gt;https://doi.org/10.1016/j.otohns.2010.05.007&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Note9 Intro to Survival Analysis</title>
      <link>/post/note9-intro-to-survival-analysis/</link>
      <pubDate>Tue, 18 Feb 2020 17:33:44 -0600</pubDate>
      <guid>/post/note9-intro-to-survival-analysis/</guid>
      <description>


&lt;div id=&#34;time-to-event-data&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:Red&#34;&gt;Time to Event Data&lt;/span&gt;&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Keywords&lt;/strong&gt;: Failure, Lifetime Data, Time-event, Time-to-event-data&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Outcome&lt;/strong&gt;: Time until some events occures -&amp;gt; survival analysis.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;In order to measure survival time, need a begining(t=0) and end(t = T).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;t=0&lt;/strong&gt; is when the clock starts.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;t=T&lt;/strong&gt; is when the event occurs(or censored) + clock stops.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Between this two times(t - T), the subject is said to be “at risk” for the event.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Survival time T is the difference between these two points.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Usually measured in days, months or years.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Question: Time is continuous, why not using linear regression?&lt;/p&gt;
&lt;p&gt;Answer: Censoring! If no censoring, you can use it!&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;censoring&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:Red&#34;&gt;Censoring&lt;/span&gt;&lt;/h2&gt;
&lt;div id=&#34;right-censoredby-for-the-most-common&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Right Censored(by for the most common)&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;known survival time is greater than some value: T &amp;gt; a&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;left-censoredrare&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Left Censored(rare)&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;known survival time is less than some value: T &amp;lt; b&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;interval-censored&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Interval Censored&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;known survival time is within some interval: a &amp;lt; T &amp;lt; b&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;functions-of-survival-time&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:Red&#34;&gt;Functions of Survival Time&lt;/span&gt;&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;PDF: f(t)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;CDF: F(t) = P(T&amp;lt;t)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Survival Function S(t): S(t) = P(T&amp;gt;t) = 1 - F(t), this is the prob that people survived passed t.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Unconditional probability failure rate f(t): &lt;span class=&#34;math inline&#34;&gt;\(f(t) = \lim_{\Delta t\to\ 0}\frac{P(t \leq T \leq t + \Delta t)}{\Delta t}\)&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;But, subjects who have died before time t are no longer at risk during (t, t + t).&lt;br /&gt;
So it make sense to think of a conditional failure rate.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Conditional failure rate: risk of an event occuring at time t, given the subject has survived to time t.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Hazard Function h(t)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(h(t) = \lim_{\Delta t\to\ 0}\frac{P(t \leq T \leq t + \Delta t | T \geq t)}{\Delta t}\)&lt;/span&gt;, &lt;span style=&#34;color:orange&#34;&gt;h(t) &amp;gt; 0, h(t) is not a probability. The hazard function, h(t), is the instantaneous rate at which events occur, given no previous events.&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Cumulative Hazard Function H(t)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(H(t) = \int\limits_{0}^{t} h(u) du\)&lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Relationships between S(t), H(t), h(t), f(t)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(h(t) = - \frac{\partial log(S(t))}{\partial t} = \frac{f(t)}{S(t)}\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(H(t) = -log(S(t))\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(S(t) = exp(-H(t))\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(f(t) = - \frac{\partial S(t)}{\partial t}\)&lt;/span&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;comment-for-survival-distributions&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;&lt;span style=&#34;color:red&#34;&gt; Comment for Survival Distributions&lt;/span&gt;&lt;/h2&gt;
&lt;table&gt;
&lt;colgroup&gt;
&lt;col width=&#34;46%&#34; /&gt;
&lt;col width=&#34;17%&#34; /&gt;
&lt;col width=&#34;17%&#34; /&gt;
&lt;col width=&#34;17%&#34; /&gt;
&lt;/colgroup&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th&gt;Distribution&lt;/th&gt;
&lt;th&gt;h(t)&lt;/th&gt;
&lt;th&gt;S(t)&lt;/th&gt;
&lt;th&gt;f(t)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;Exponential&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(\lambda\)&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(exp(-\lambda t)\)&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(\lambda exp(-\lambda t)\)&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;Weibull&lt;/td&gt;
&lt;td&gt;$t^{-1} $&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(exp(-\lambda t^\alpha)\)&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(\alpha \lambda t^{\alpha -1}exp(-\lambda t^\alpha)\)&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;Gompertze&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(\theta exp(\alpha t)\)&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(exp(\frac{\theta}{\alpha}(1-exp(\alpha t)))\)&lt;/span&gt;&lt;/td&gt;
&lt;td&gt;&lt;span class=&#34;math inline&#34;&gt;\(\theta exp(\alpha t)exp(\frac{\theta}{\alpha}(1-exp(\alpha t)))\)&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Others: Gamma, lognormal, log-logistic, inverse gaussian, Pareto&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
  </channel>
</rss>
